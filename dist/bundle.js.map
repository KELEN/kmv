{"version":3,"sources":["webpack:///bundle.js","webpack:///webpack/bootstrap 45eac28ab7ceeabdd008","webpack:///./src/index.ts","webpack:///./src/constants/constant.ts","webpack:///./src/util/object.ts","webpack:///./src/dom/domOp.ts","webpack:///./src/vdom/VDOM.ts","webpack:///./src/util/template.ts","webpack:///./src/dom/event.ts","webpack:///./src/util/RenderQueue.ts","webpack:///./src/util/array.ts","webpack:///./src/util/function.ts","webpack:///./src/util/observer.ts","webpack:///./src/util/render.ts","webpack:///./src/util/validator.ts","webpack:///./src/vdom/ForDOM.ts","webpack:///./src/vdom/ForItemDOM.ts","webpack:///./src/vdom/ForNormalDOM.ts","webpack:///./src/vdom/IfDOM.ts","webpack:///./src/vdom/InputDOM.ts","webpack:///./src/vdom/NormalDOM.ts"],"names":["modules","__webpack_require__","moduleId","installedModules","exports","module","id","loaded","call","m","c","p","Kmv","opts","elSelector","elem","document","querySelector","this","data","renderQueue","RenderQueue_1","RenderQueue","$data","observer_1","observer","watch","pendingValue","pendingArray","circle","changeQueue","methods","render_1","renderInit","window","Object","defineProperty","value","default","Attr","K_MODEL","RegexpStr","brace","forStatement","bracket","isString","isParams","arithmeticOp","inputElement","arrtibuteKey","kAttribute","kOnAttribute","methodAndParam","isTernaryOp","ternaryOpSplit","NodeType","ELEMENT","ATTRIBUTE","TEXT","COMMENT","DOCUMENT","ArrayMethod","RenderType","ArrayOp","constant_1","getDotVal","obj","key","val","k","replace","arr","split","shift","undefined","depCopy","newObj","i","Array","isArray","slice","setObserveDotVal","observeData","tmp","len","length","insertAfter","node","newNode","parentNode","insertBefore","nextSibling","createTextNode","text","createElement","tagName","inserBefore","deleteNode","parent","removeChild","changeNodeValue","firstChild","nodeValue","changeTextContent","textNode","textContent","removeAttribute","attr","findIteratorNode","childrens","childNodes","iteratorNodes","forString","forKey","push","concat","hideNode","style","display","showNode","removeNode","template_1","validator_1","constant_2","event_1","object_1","VDOM","vdomAttr","attributes","prototype","renderAttr","kmv","nodeType","$dom","attrs","console","log","attrName","nodeName","attrVal","test","valRes","n","ak","trim","setAttribute","event_2","func","compileTpl","match","method","params","bindEvent","reRenderAttr","isKvmAttribute","event_3","function_1","transArithmeticOp","tpl","opReg","opRegArr","isParamReg","newStr","isNaN","res","eval","transTernaryOperator","item","str","_data","regRes","braceReg","exec","evalJs","event","param","methodsObj","addEventListener","apply","attachEvent","ForDOM_1","NormalDOM_1","InputDOM_1","IfDOM_1","queue","queueInit","getQueue","child","NormalDOM","getAttribute","ForDOM","InputDOM","IfDOM","diff","arr1","arr2","change","len1","len2","Math","min","op","CHANGE","index","deleteArr","POP","addArr","batch","PUSH","array","content","Function","evalFunc","code","arrayObserve","bigKey","forEach","configurable","enumerable","writable","arguments","ObjectUtil","_loop_1","set","newVal","get","array_1","watcher","nextTick","setTimeout","lastOne","pop","reRender","reRenderFor","vnode","renderType","FOR","arrKey","forObjectKey","newArray","iteratorData","notifyDataChange","isBraceReg","isForStatement","validator","ForItemDOM_1","DomOp","childrenVdom","previousSibling","templateNode","connect","previousElementSibling","nextElementSibling","docFrag","createDocumentFragment","forItem","ForItemDOM","forItemDom","transDOM","appendChild","realPrevDom","realNextDom","$nextSibling","idx","arrayData","batchAdd","addNewItem","popItem","changeItem","SHIFT","shiftItem","newItem","newDom","popVdom","shiftVdom","__extends","d","b","__","constructor","hasOwnProperty","create","DomUtil","ForNormalDOM_1","VDOM_1","_super","_this","childNode","ForNormalDOM","iteratorVal","iteratorKey","newElem","$$data","template","newEle","kif","isShow","kmodel","oninput","ev"],"mappings":"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","file":"bundle.js","sourcesContent":["/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar render_1 = __webpack_require__(11);\r\n\tvar observer_1 = __webpack_require__(10);\r\n\tvar RenderQueue_1 = __webpack_require__(7);\r\n\tfunction Kmv(opts) {\r\n\t    var elSelector = opts['el'];\r\n\t    var elem = document.querySelector(elSelector);\r\n\t    this.data = opts.data;\r\n\t    // 获取需要渲染的dom列表\r\n\t    this.renderQueue = new RenderQueue_1.RenderQueue(elem);\r\n\t    // 原始数据\r\n\t    this.$data = observer_1.observer(opts.data, this);\r\n\t    this.watch = opts.watch || {};\r\n\t    this.pendingValue = false;\r\n\t    this.pendingArray = false;\r\n\t    this.circle = {};\r\n\t    this.changeQueue = [];\r\n\t    this.methods = opts.methods;\r\n\t    render_1.renderInit(this);\r\n\t    return this;\r\n\t}\r\n\twindow.Kmv = Kmv;\r\n\tObject.defineProperty(exports, \"__esModule\", { value: true });\r\n\texports.default = Kmv;\r\n\n\n/***/ },\n/* 1 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\r\n\t/**\r\n\t *   URL:\r\n\t *   说明:\r\n\t *   负责人: kelen\r\n\t *   日期:  1/24 0024.\r\n\t */\r\n\texports.Attr = {\r\n\t    K_MODEL: 'k-model'\r\n\t};\r\n\texports.RegexpStr = {\r\n\t    brace: /\\{\\{((?:.|\\n)+?)\\}\\}/,\r\n\t    forStatement: /([a-z_]+[\\w]*)\\s+in\\s+([a-z_][\\w.]+)/,\r\n\t    bracket: /\\[['|\"]?(\\w+)['|\"]?\\]/,\r\n\t    isString: /'([^']*)'|\"([^\\\"]*)\"/,\r\n\t    isParams: /^[^\"|^'\\d]+.*/,\r\n\t    arithmeticOp: /\\*|\\+|-\\/|\\(|\\)/g,\r\n\t    inputElement: /INPUT|TEXTAREA/,\r\n\t    arrtibuteKey: /k-for|k-model|k-if|k:.*|k-on:(.*)/,\r\n\t    kAttribute: /k:(.*)/,\r\n\t    kOnAttribute: /k-on:(.*)/,\r\n\t    methodAndParam: /([a-zA-Z\\d_]+)\\((.*)\\)/,\r\n\t    isTernaryOp: /!.*|!!.*|.+?.+:.+/,\r\n\t    ternaryOpSplit: /\\?|:|\\(|\\)|!!/ // 正则切割\r\n\t};\r\n\texports.NodeType = {\r\n\t    ELEMENT: 1,\r\n\t    ATTRIBUTE: 2,\r\n\t    TEXT: 3,\r\n\t    COMMENT: 8,\r\n\t    DOCUMENT: 9\r\n\t};\r\n\texports.ArrayMethod = ['push', 'pop', 'splice', 'shift', 'unshift', 'sort', 'reverse'];\r\n\tvar RenderType;\r\n\t(function (RenderType) {\r\n\t    RenderType[RenderType[\"TEXT\"] = 0] = \"TEXT\";\r\n\t    RenderType[RenderType[\"INPUT\"] = 1] = \"INPUT\";\r\n\t    RenderType[RenderType[\"TEXTAREA\"] = 2] = \"TEXTAREA\";\r\n\t    RenderType[RenderType[\"FOR\"] = 3] = \"FOR\";\r\n\t    RenderType[RenderType[\"IF\"] = 4] = \"IF\";\r\n\t    RenderType[RenderType[\"ATTRIBUTE\"] = 5] = \"ATTRIBUTE\";\r\n\t})(RenderType = exports.RenderType || (exports.RenderType = {}));\r\n\tvar ArrayOp;\r\n\t(function (ArrayOp) {\r\n\t    ArrayOp[ArrayOp[\"PUSH\"] = 0] = \"PUSH\";\r\n\t    ArrayOp[ArrayOp[\"POP\"] = 1] = \"POP\";\r\n\t    ArrayOp[ArrayOp[\"SORT\"] = 2] = \"SORT\";\r\n\t    ArrayOp[ArrayOp[\"CHANGE\"] = 3] = \"CHANGE\";\r\n\t    ArrayOp[ArrayOp[\"SHIFT\"] = 4] = \"SHIFT\";\r\n\t})(ArrayOp = exports.ArrayOp || (exports.ArrayOp = {}));\r\n\n\n/***/ },\n/* 2 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar constant_1 = __webpack_require__(1);\r\n\texports.getDotVal = function (obj, key) {\r\n\t    var val, k;\r\n\t    if (key) {\r\n\t        key = key.replace(constant_1.RegexpStr.bracket, \".$1\"); // 把arr['name']/arr[\"name\"]/arr[0] 转为 arr.name/arr.0\r\n\t        val = obj;\r\n\t        // 获取对应的dot值\r\n\t        var arr = key.split(\".\") || [key];\r\n\t        while (k = arr.shift()) {\r\n\t            if (!val) {\r\n\t                val = undefined;\r\n\t                break;\r\n\t            }\r\n\t            val = val[k];\r\n\t        }\r\n\t    }\r\n\t    return val;\r\n\t};\r\n\texports.depCopy = function (obj) {\r\n\t    var newObj = {};\r\n\t    for (var i in obj) {\r\n\t        if (typeof obj[i] === 'object') {\r\n\t            if (Array.isArray(obj[i])) {\r\n\t                newObj[i] = obj[i].slice(0);\r\n\t            }\r\n\t            else {\r\n\t                newObj[i] = exports.depCopy(obj[i]);\r\n\t            }\r\n\t        }\r\n\t        else {\r\n\t            newObj[i] = obj[i];\r\n\t        }\r\n\t    }\r\n\t    return newObj;\r\n\t};\r\n\texports.setObserveDotVal = function (observeData, key, val) {\r\n\t    key = key.replace(constant_1.RegexpStr.bracket, \".$1\"); // 把arr['name']/arr[\"name\"]/arr[0] 转为 arr.name/arr.0\r\n\t    var tmp = observeData;\r\n\t    var arr = key.split(\".\");\r\n\t    var len = arr.length;\r\n\t    for (var i = 0; i < len - 1; i++) {\r\n\t        tmp = tmp[arr[i]];\r\n\t    }\r\n\t    tmp[arr[len - 1]] = val;\r\n\t};\r\n\n\n/***/ },\n/* 3 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\r\n\texports.insertAfter = function (node, newNode) {\r\n\t    node && node.parentNode && node.parentNode.insertBefore(newNode, node.nextSibling);\r\n\t};\r\n\texports.createTextNode = function (text) {\r\n\t    return document.createTextNode(text);\r\n\t};\r\n\texports.createElement = function (tagName) {\r\n\t    return document.createElement(tagName);\r\n\t};\r\n\texports.inserBefore = function (node, newNode) {\r\n\t    node && node.parentNode && node.parentNode.insertBefore(newNode, node);\r\n\t};\r\n\texports.deleteNode = function (parent, node) {\r\n\t    parent && node && parent.removeChild(node);\r\n\t};\r\n\texports.changeNodeValue = function (node, text) {\r\n\t    node && node.firstChild && (node.firstChild.nodeValue = text);\r\n\t};\r\n\texports.changeTextContent = function (textNode, text) {\r\n\t    textNode && (textNode.textContent = text);\r\n\t};\r\n\texports.removeAttribute = function (node, attr) {\r\n\t    node && node.removeAttribute(attr);\r\n\t};\r\n\texports.findIteratorNode = function (parentNode, key) {\r\n\t    var childrens = parentNode.childNodes;\r\n\t    var iteratorNodes = [];\r\n\t    for (var i = 0; i < childrens.length; i++) {\r\n\t        var node = childrens[i];\r\n\t        if (node.forString && node.forKey && node.forKey == key) {\r\n\t            iteratorNodes.push(node);\r\n\t        }\r\n\t        if (node.childNodes.length) {\r\n\t            iteratorNodes.concat(exports.findIteratorNode(node, key));\r\n\t        }\r\n\t    }\r\n\t    return iteratorNodes;\r\n\t};\r\n\texports.hideNode = function (node) {\r\n\t    node.style.display = \"none\";\r\n\t};\r\n\texports.showNode = function (node) {\r\n\t    node.style.display = \"block\";\r\n\t};\r\n\texports.removeNode = function (node) {\r\n\t    node && node.parentNode.removeChild(node);\r\n\t};\r\n\n\n/***/ },\n/* 4 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar template_1 = __webpack_require__(5);\r\n\tvar constant_1 = __webpack_require__(1);\r\n\tvar validator_1 = __webpack_require__(12);\r\n\tvar constant_2 = __webpack_require__(1);\r\n\tvar event_1 = __webpack_require__(6);\r\n\tvar object_1 = __webpack_require__(2);\r\n\tvar VDOM = (function () {\r\n\t    function VDOM(node) {\r\n\t        this.vdomAttr = {};\r\n\t        node.attributes && (this.attributes = [].slice.call(node.attributes).slice(0));\r\n\t    }\r\n\t    VDOM.prototype.renderAttr = function (kmv) {\r\n\t        if (this.nodeType === constant_1.NodeType.ELEMENT) {\r\n\t            var data = kmv.$data;\r\n\t            var node = this.$dom;\r\n\t            var attrs = this.attributes;\r\n\t            console.log(attrs);\r\n\t            for (var i = 0; i < attrs.length; i++) {\r\n\t                var attr = attrs[i];\r\n\t                var attrName = attr.nodeName, attrVal = attr.nodeValue;\r\n\t                if (constant_2.RegexpStr.kAttribute.test(attrName)) {\r\n\t                    var key = attr.nodeName.replace(constant_2.RegexpStr.kAttribute, '$1');\r\n\t                    if (key === 'class') {\r\n\t                        // 类 a:'class2', b:'class2'\r\n\t                        var arr = attrVal.split(\",\");\r\n\t                        var valRes = \"\";\r\n\t                        for (var n = 0; n < arr.length; n++) {\r\n\t                            var ak = arr[n].split(\":\")[0];\r\n\t                            if (object_1.getDotVal(data, ak.trim())) {\r\n\t                                valRes += arr[n].split(\":\")[1].trim() + \" \";\r\n\t                            }\r\n\t                        }\r\n\t                        node.setAttribute(key, valRes.trim());\r\n\t                        node.removeAttribute(attrName);\r\n\t                    }\r\n\t                    else {\r\n\t                        var val = object_1.getDotVal(data, attrVal);\r\n\t                        node.setAttribute(key, val);\r\n\t                        node.removeAttribute(attrName);\r\n\t                    }\r\n\t                }\r\n\t                else if (constant_2.RegexpStr.kOnAttribute.test(attrName)) {\r\n\t                    var event_2 = attrName.replace(constant_2.RegexpStr.kOnAttribute, '$1');\r\n\t                    var func = template_1.compileTpl(attrVal, data);\r\n\t                    var match = func.match(constant_2.RegexpStr.methodAndParam);\r\n\t                    var method = match[1];\r\n\t                    var params = match[2];\r\n\t                    event_1.bindEvent(node, event_2, method, params, kmv.methods, kmv.data);\r\n\t                    node.removeAttribute(attrName);\r\n\t                }\r\n\t                else {\r\n\t                    node.setAttribute(attrName, attrVal);\r\n\t                }\r\n\t            }\r\n\t        }\r\n\t    };\r\n\t    VDOM.prototype.reRenderAttr = function (kmv) {\r\n\t        if (this.nodeType === constant_1.NodeType.ELEMENT) {\r\n\t            var data = kmv.data;\r\n\t            var node = this.$dom;\r\n\t            for (var i = 0; i < this.attributes.length; i++) {\r\n\t                var attr = this.attributes[i];\r\n\t                var attrName = attr.nodeName, attrVal = attr.nodeValue;\r\n\t                if (validator_1.isKvmAttribute(attrName)) {\r\n\t                    if (constant_2.RegexpStr.kAttribute.test(attrName)) {\r\n\t                        var key = attr.nodeName.replace(constant_2.RegexpStr.kAttribute, '$1');\r\n\t                        if (key === 'class') {\r\n\t                            // 类 a:'class2', b:'class2'\r\n\t                            var arr = attrVal.split(\",\");\r\n\t                            var valRes = \"\";\r\n\t                            for (var n = 0; n < arr.length; n++) {\r\n\t                                var ak = arr[n].split(\":\")[0];\r\n\t                                if (object_1.getDotVal(data, ak.trim())) {\r\n\t                                    valRes += arr[n].split(\":\")[1].trim() + \" \";\r\n\t                                }\r\n\t                            }\r\n\t                            node.setAttribute(key, valRes.trim());\r\n\t                            node.removeAttribute(attrName);\r\n\t                        }\r\n\t                        else {\r\n\t                            var val = object_1.getDotVal(data, attrVal);\r\n\t                            node.setAttribute(key, val);\r\n\t                            node.removeAttribute(attrName);\r\n\t                        }\r\n\t                    }\r\n\t                    else if (constant_2.RegexpStr.kOnAttribute.test(attrName)) {\r\n\t                        var event_3 = attrName.replace(constant_2.RegexpStr.kOnAttribute, '$1');\r\n\t                        var func = template_1.compileTpl(attrVal, data);\r\n\t                        var match = func.match(constant_2.RegexpStr.methodAndParam);\r\n\t                        var method = match[1];\r\n\t                        var params = match[2];\r\n\t                        event_1.bindEvent(node, event_3, method, params, kmv.methods, kmv.data);\r\n\t                        node.removeAttribute(attrName);\r\n\t                    }\r\n\t                    else {\r\n\t                        node.setAttribute(attrName, template_1.compileTpl(attrVal, data));\r\n\t                    }\r\n\t                }\r\n\t                else {\r\n\t                    node.setAttribute(attrName, attrVal);\r\n\t                }\r\n\t            }\r\n\t        }\r\n\t    };\r\n\t    return VDOM;\r\n\t}());\r\n\texports.VDOM = VDOM;\r\n\n\n/***/ },\n/* 5 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar constant_1 = __webpack_require__(1);\r\n\tvar object_1 = __webpack_require__(2);\r\n\tvar function_1 = __webpack_require__(9);\r\n\t/**\r\n\t *  转换逻辑操作运算结果\r\n\t *\r\n\t */\r\n\texports.transArithmeticOp = function (tpl, obj) {\r\n\t    var opReg = constant_1.RegexpStr.arithmeticOp;\r\n\t    var arr = tpl.split(opReg); // 符号切分\r\n\t    var opRegArr = tpl.match(opReg);\r\n\t    var isParamReg = constant_1.RegexpStr.isParams;\r\n\t    var tmp;\r\n\t    var newStr = '';\r\n\t    for (var i = 0; i < arr.length; i++) {\r\n\t        tmp = arr[i].trim();\r\n\t        if (isParamReg.test(tmp)) {\r\n\t            // 如果是变量\r\n\t            var val = object_1.getDotVal(obj, tmp);\r\n\t            if (isNaN(val)) {\r\n\t                newStr += '\"' + val + '\"';\r\n\t            }\r\n\t            else {\r\n\t                if (!val)\r\n\t                    val = 0;\r\n\t                newStr += val;\r\n\t            }\r\n\t        }\r\n\t        else {\r\n\t            newStr += tmp;\r\n\t        }\r\n\t        if (i < arr.length - 1) {\r\n\t            newStr += opRegArr[i];\r\n\t        }\r\n\t    }\r\n\t    var res = eval(newStr);\r\n\t    return res;\r\n\t};\r\n\texports.transTernaryOperator = function (tpl, obj) {\r\n\t    var arr = tpl.split(/\\?|:|\\(|\\)|\\+|-|\\*|\\/|!/);\r\n\t    var match = tpl.match(/\\?|:|\\(|\\)|\\+|-|\\*|\\/|!/g);\r\n\t    var newStr = '';\r\n\t    for (var i = 0; i < arr.length; i++) {\r\n\t        var item = arr[i].trim();\r\n\t        if (item && constant_1.RegexpStr.isParams.test(item)) {\r\n\t            newStr += '_data.' + item;\r\n\t        }\r\n\t        else {\r\n\t            newStr += item;\r\n\t        }\r\n\t        if (match[i])\r\n\t            newStr += match[i];\r\n\t    }\r\n\t    return (function (str, _data) {\r\n\t        return eval(str);\r\n\t    })(newStr, obj);\r\n\t};\r\n\texports.compileTpl = function (tpl, obj) {\r\n\t    var braceReg = constant_1.RegexpStr.brace;\r\n\t    var regRes;\r\n\t    while (regRes = braceReg.exec(tpl)) {\r\n\t        var key = regRes ? regRes[1].trim() : ''; // 获取括号的键\r\n\t        if (key) {\r\n\t            var text = function_1.evalJs(key, obj);\r\n\t            tpl = tpl.replace(braceReg, text);\r\n\t        }\r\n\t        else {\r\n\t            return '';\r\n\t        }\r\n\t    }\r\n\t    /*var regRes;\r\n\t    while (regRes = braceReg.exec(tpl)) {\r\n\t        let key = regRes ? regRes[1].trim() : '';\t// 获取括号的键\r\n\t        let opReg = RegexpStr.arithmeticOp;     // 是否有操作符\r\n\t        let text = '';\r\n\t        if (key) {\r\n\t            if (opReg.test(key)) {\r\n\t                text = transArithmeticOp(key, obj);\r\n\t            } else if (RegexpStr.isTernaryOp.test(key)) {\r\n\t                text = transTernaryOperator(key, obj);\r\n\t            } else {\r\n\t                text = getDotVal(obj, key);\r\n\t            }\r\n\t            tpl = tpl.replace(braceReg, text);\r\n\t        } else {\r\n\t            return '';\r\n\t        }\r\n\t    }*/\r\n\t    return tpl;\r\n\t};\r\n\n\n/***/ },\n/* 6 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\r\n\texports.bindEvent = function (node, event, method, param, methodsObj, observeData) {\r\n\t    if (param === void 0) { param = ''; }\r\n\t    if (node.addEventListener) {\r\n\t        node.addEventListener(event, function () {\r\n\t            var params = param.split(',');\r\n\t            methodsObj[method].apply(observeData, params);\r\n\t        });\r\n\t    }\r\n\t    else {\r\n\t        node.attachEvent(\"on\" + event, function () {\r\n\t            var params = param.split(',');\r\n\t            methodsObj[method].apply(observeData, params);\r\n\t        });\r\n\t    }\r\n\t};\r\n\n\n/***/ },\n/* 7 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar constant_1 = __webpack_require__(1);\r\n\tvar ForDOM_1 = __webpack_require__(13);\r\n\tvar NormalDOM_1 = __webpack_require__(18);\r\n\tvar InputDOM_1 = __webpack_require__(17);\r\n\tvar IfDOM_1 = __webpack_require__(16);\r\n\tvar RenderQueue = (function () {\r\n\t    function RenderQueue(node) {\r\n\t        this.queue = [];\r\n\t        this.queue = this.queueInit(node);\r\n\t    }\r\n\t    RenderQueue.prototype.getQueue = function () {\r\n\t        return this.queue;\r\n\t    };\r\n\t    RenderQueue.prototype.queueInit = function (parentNode) {\r\n\t        var childNodes = parentNode.childNodes;\r\n\t        for (var i = 0; i < childNodes.length; i++) {\r\n\t            var child = childNodes[i];\r\n\t            switch (child.nodeType) {\r\n\t                case constant_1.NodeType.TEXT:\r\n\t                    this.queue.push(new NormalDOM_1.NormalDOM(child));\r\n\t                    break;\r\n\t                case constant_1.NodeType.ELEMENT:\r\n\t                    if (child.getAttribute(\"k-for\")) {\r\n\t                        this.queue.push(new ForDOM_1.ForDOM(child));\r\n\t                    }\r\n\t                    else if (child.getAttribute(\"k-model\") && constant_1.RegexpStr.inputElement.test(child.tagName)) {\r\n\t                        this.queue.push(new InputDOM_1.InputDOM(child));\r\n\t                    }\r\n\t                    else if (child.getAttribute(\"k-if\")) {\r\n\t                        this.queue.push(new IfDOM_1.IfDOM(child));\r\n\t                    }\r\n\t                    else {\r\n\t                        this.queue.push(new NormalDOM_1.NormalDOM(child));\r\n\t                    }\r\n\t                    break;\r\n\t            }\r\n\t        }\r\n\t        return this.queue;\r\n\t    };\r\n\t    return RenderQueue;\r\n\t}());\r\n\texports.RenderQueue = RenderQueue;\r\n\n\n/***/ },\n/* 8 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar constant_1 = __webpack_require__(1);\r\n\texports.diff = function (arr1, arr2) {\r\n\t    if (arr1 === void 0) { arr1 = []; }\r\n\t    if (arr2 === void 0) { arr2 = []; }\r\n\t    var change = [];\r\n\t    var len1 = arr1.length, len2 = arr2.length;\r\n\t    var len = Math.min(len1, len2);\r\n\t    for (var i = 0; i < len; i++) {\r\n\t        if (arr1[i] !== arr2[i]) {\r\n\t            change.push({\r\n\t                op: constant_1.ArrayOp.CHANGE,\r\n\t                index: i,\r\n\t                text: arr2[i]\r\n\t            });\r\n\t        }\r\n\t    }\r\n\t    if (len1 > len2) {\r\n\t        var deleteArr = arr1.slice(len2);\r\n\t        // 删除dom\r\n\t        for (var i = 0; i < deleteArr.length; i++) {\r\n\t            change.push({\r\n\t                op: constant_1.ArrayOp.POP,\r\n\t                index: i + len2,\r\n\t                text: deleteArr[i]\r\n\t            });\r\n\t        }\r\n\t    }\r\n\t    else {\r\n\t        var addArr = arr2.slice(len1);\r\n\t        change.push({\r\n\t            batch: true,\r\n\t            op: constant_1.ArrayOp.PUSH,\r\n\t            array: addArr\r\n\t        });\r\n\t    }\r\n\t    return change;\r\n\t};\r\n\n\n/***/ },\n/* 9 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\r\n\texports.evalJs = function (content, obj) {\r\n\t    // console.dir(obj);\r\n\t    // return (function() { return eval(content) }).call(obj);\r\n\t    return new Function(\"with(this){ return \" + content + \" }\").call(obj);\r\n\t};\r\n\texports.evalFunc = function (code) {\r\n\t    return new Function(\"with(this){ console.log(this); return \" + code + \" }\");\r\n\t};\r\n\n\n/***/ },\n/* 10 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar ObjectUtil = __webpack_require__(2);\r\n\tvar constant_1 = __webpack_require__(1);\r\n\tvar object_1 = __webpack_require__(2);\r\n\t/**\r\n\t *   URL:\r\n\t *   说明:\r\n\t *   负责人: kelen\r\n\t *   日期:  1/24 0024.\r\n\t */\r\n\texports.observer = function (obj, kmv, key) {\r\n\t    if (key === void 0) { key = ''; }\r\n\t    var newObj = ObjectUtil.depCopy(obj);\r\n\t    var _loop_1 = function (i) {\r\n\t        var bigKey = key ? key + \".\" + i : i;\r\n\t        if (typeof obj[i] == 'object') {\r\n\t            if (Array.isArray(obj[i])) {\r\n\t                arrayObserve(obj[i], kmv, bigKey);\r\n\t            }\r\n\t            else {\r\n\t                exports.observer(obj[i], kmv, bigKey);\r\n\t            }\r\n\t        }\r\n\t        else {\r\n\t            Object.defineProperty(obj, i, {\r\n\t                set: function (newVal) {\r\n\t                    ObjectUtil.setObserveDotVal(kmv.$data, bigKey, newVal);\r\n\t                    kmv.pendingValue = true;\r\n\t                    kmv.changeQueue.push({\r\n\t                        kmv: kmv,\r\n\t                        bigKey: bigKey\r\n\t                    });\r\n\t                    kmv.watch[bigKey] && kmv.watch[bigKey].call(kmv.data, newVal);\r\n\t                },\r\n\t                get: function () {\r\n\t                    return object_1.getDotVal(kmv.$data, bigKey);\r\n\t                }\r\n\t            });\r\n\t        }\r\n\t    };\r\n\t    for (var i in obj) {\r\n\t        _loop_1(i);\r\n\t    }\r\n\t    return newObj;\r\n\t};\r\n\tfunction arrayObserve(arr, kmv, bigKey) {\r\n\t    // 监听array操作\r\n\t    constant_1.ArrayMethod.forEach(function (method) {\r\n\t        Object.defineProperty(arr, method, {\r\n\t            configurable: false,\r\n\t            enumerable: false,\r\n\t            writable: false,\r\n\t            value: function () {\r\n\t                Array.prototype[method].apply(object_1.getDotVal(kmv.$data, bigKey), arguments);\r\n\t                kmv.changeQueue.push({\r\n\t                    kmv: kmv,\r\n\t                    bigKey: bigKey\r\n\t                });\r\n\t                kmv.pendingArray = true;\r\n\t                // reRenderFor(kmv, bigKey);\r\n\t            }\r\n\t        });\r\n\t    });\r\n\t}\r\n\n\n/***/ },\n/* 11 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar constant_1 = __webpack_require__(1);\r\n\tvar object_1 = __webpack_require__(2);\r\n\tvar array_1 = __webpack_require__(8);\r\n\texports.renderInit = function (kmv) {\r\n\t    var watcher = kmv.renderQueue;\r\n\t    var renderQueue = watcher.getQueue();\r\n\t    for (var i = 0; i < renderQueue.length; i++) {\r\n\t        var node = renderQueue[i];\r\n\t        node.renderInit(kmv);\r\n\t    }\r\n\t    exports.nextTick(kmv);\r\n\t};\r\n\texports.nextTick = function (kmv) {\r\n\t    setTimeout(function () {\r\n\t        if (kmv.pendingValue) {\r\n\t            console.log(\"reRender\");\r\n\t            kmv.pendingValue = false;\r\n\t            var lastOne = kmv.changeQueue.pop();\r\n\t            exports.reRender(lastOne.kmv, lastOne.bigKey);\r\n\t            kmv.changeQueue.length = 0;\r\n\t        }\r\n\t        if (kmv.pendingArray) {\r\n\t            console.log(\"reRenderFor\");\r\n\t            kmv.pendingArray = false;\r\n\t            var lastOne = kmv.changeQueue.pop();\r\n\t            exports.reRenderFor(lastOne.kmv, lastOne.bigKey);\r\n\t            kmv.changeQueue.length = 0;\r\n\t        }\r\n\t        // 下一次事件循环\r\n\t        exports.nextTick(kmv);\r\n\t    }, 0);\r\n\t};\r\n\texports.reRender = function (kmv, key) {\r\n\t    var renderQueue = kmv.renderQueue.getQueue();\r\n\t    for (var i = 0; i < renderQueue.length; i++) {\r\n\t        var node = renderQueue[i];\r\n\t        node.reRender(kmv);\r\n\t    }\r\n\t};\r\n\texports.reRenderFor = function (kmv, forKey) {\r\n\t    var renderQueue = kmv.renderQueue.getQueue();\r\n\t    var data = kmv.$data;\r\n\t    for (var i = 0; i < renderQueue.length; i++) {\r\n\t        var vnode = renderQueue[i];\r\n\t        if (vnode.renderType == constant_1.RenderType.FOR) {\r\n\t            var arrKey = vnode.forObjectKey;\r\n\t            var newArray = object_1.getDotVal(data, arrKey);\r\n\t            if (Array.isArray(newArray)) {\r\n\t                var change = array_1.diff(vnode.iteratorData, newArray);\r\n\t                vnode.notifyDataChange(change, kmv);\r\n\t            }\r\n\t            else {\r\n\t                vnode.notifyDataChange(null, kmv);\r\n\t            }\r\n\t        }\r\n\t    }\r\n\t};\r\n\n\n/***/ },\n/* 12 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar constant_1 = __webpack_require__(1);\r\n\tvar isBraceReg = function (str) {\r\n\t    return constant_1.RegexpStr.brace.test(str);\r\n\t};\r\n\t/**\r\n\t *  是否有包含语法\r\n\t * @param str\r\n\t */\r\n\tvar isForStatement = function (str) {\r\n\t    return constant_1.RegexpStr.forStatement.test(str);\r\n\t};\r\n\tvar validator = {\r\n\t    isBraceReg: isBraceReg,\r\n\t    isForStatement: isForStatement\r\n\t};\r\n\texports.isKvmAttribute = function (key) {\r\n\t    return constant_1.RegexpStr.arrtibuteKey.test(key);\r\n\t};\r\n\tObject.defineProperty(exports, \"__esModule\", { value: true });\r\n\texports.default = validator;\r\n\n\n/***/ },\n/* 13 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar ForItemDOM_1 = __webpack_require__(14);\r\n\tvar constant_1 = __webpack_require__(1);\r\n\tvar object_1 = __webpack_require__(2);\r\n\tvar DomOp = __webpack_require__(3);\r\n\tvar ForDOM = (function () {\r\n\t    function ForDOM(node) {\r\n\t        this.childrenVdom = [];\r\n\t        this.renderType = constant_1.RenderType.FOR;\r\n\t        this.previousSibling = node.previousSibling;\r\n\t        this.nextSibling = node.nextSibling;\r\n\t        this.templateNode = node;\r\n\t        this.connect(node.previousElementSibling, node.nextElementSibling);\r\n\t        var forString = node.getAttribute(\"k-for\");\r\n\t        var match = constant_1.RegexpStr.forStatement.exec(forString);\r\n\t        this.tagName = node.tagName;\r\n\t        this.forString = forString;\r\n\t        this.forObjectKey = match[2].trim();\r\n\t        this.forKey = match[1].trim();\r\n\t        DomOp.removeNode(node);\r\n\t    }\r\n\t    ForDOM.prototype.renderInit = function (kmv) {\r\n\t        var iteratorData = object_1.getDotVal(kmv.$data, this.forObjectKey);\r\n\t        var docFrag = document.createDocumentFragment();\r\n\t        if (Array.isArray(iteratorData)) {\r\n\t            this.iteratorData = iteratorData.slice(0);\r\n\t            for (var i = 0; i < this.iteratorData.length; i++) {\r\n\t                var forItem = new ForItemDOM_1.ForItemDOM(this.templateNode);\r\n\t                this.childrenVdom.push(forItem);\r\n\t                var forItemDom = forItem.transDOM(this.iteratorData[i], this.forKey, kmv);\r\n\t                docFrag.appendChild(forItemDom);\r\n\t            }\r\n\t            DomOp.insertAfter(this.previousSibling, docFrag);\r\n\t        }\r\n\t        else if (typeof iteratorData === 'object') {\r\n\t            this.iteratorData = iteratorData;\r\n\t            for (var i in iteratorData) {\r\n\t                var forItem = new ForItemDOM_1.ForItemDOM(this.templateNode);\r\n\t                this.childrenVdom.push(forItem);\r\n\t                var forItemDom = forItem.transDOM(iteratorData[i], this.forKey, kmv);\r\n\t                docFrag.appendChild(forItemDom);\r\n\t            }\r\n\t            DomOp.insertAfter(this.previousSibling, docFrag);\r\n\t        }\r\n\t        this.connect(this.previousSibling, this.nextSibling);\r\n\t    };\r\n\t    ForDOM.prototype.connect = function (realPrevDom, realNextDom) {\r\n\t        realPrevDom && (realPrevDom.$nextSibling = this);\r\n\t        this.$nextSibling = realNextDom;\r\n\t    };\r\n\t    ForDOM.prototype.reRender = function (kmv) {\r\n\t        if (Array.isArray(this.iteratorData)) {\r\n\t            for (var i = 0, len = this.iteratorData.length; i < len; i++) {\r\n\t                this.childrenVdom[i].reRender(this.iteratorData[i], this.forKey, kmv);\r\n\t            }\r\n\t        }\r\n\t        else {\r\n\t            // 渲染对象\r\n\t            var idx = 0;\r\n\t            for (var key in this.iteratorData) {\r\n\t                this.childrenVdom[idx].reRender(this.iteratorData[key], this.forKey, kmv);\r\n\t                idx++;\r\n\t            }\r\n\t        }\r\n\t    };\r\n\t    ForDOM.prototype.notifyDataChange = function (change, kmv) {\r\n\t        var data = kmv.$data;\r\n\t        var arrKey = this.forObjectKey;\r\n\t        var arrayData = object_1.getDotVal(data, arrKey) || [];\r\n\t        if (Array.isArray(this.iteratorData)) {\r\n\t            this.iteratorData = arrayData.slice(0);\r\n\t            for (var i = 0; i < change.length; i++) {\r\n\t                var op = change[i].op;\r\n\t                if (change[i].batch) {\r\n\t                    switch (op) {\r\n\t                        case constant_1.ArrayOp.PUSH:\r\n\t                            this.batchAdd(change[i].array, kmv);\r\n\t                            break;\r\n\t                    }\r\n\t                }\r\n\t                else {\r\n\t                    switch (op) {\r\n\t                        case constant_1.ArrayOp.PUSH:\r\n\t                            this.addNewItem(change[i].text, kmv);\r\n\t                            break;\r\n\t                        case constant_1.ArrayOp.POP:\r\n\t                            this.popItem();\r\n\t                            break;\r\n\t                        case constant_1.ArrayOp.CHANGE:\r\n\t                            this.changeItem(change[i].index, kmv);\r\n\t                            break;\r\n\t                        case constant_1.ArrayOp.SHIFT:\r\n\t                            this.shiftItem();\r\n\t                            break;\r\n\t                    }\r\n\t                }\r\n\t            }\r\n\t        }\r\n\t    };\r\n\t    ForDOM.prototype.batchAdd = function (arr, kmv) {\r\n\t        if (arr === void 0) { arr = []; }\r\n\t        var docFrag = document.createDocumentFragment();\r\n\t        for (var i = 0, len = arr.length; i < len; i++) {\r\n\t            var newItem = new ForItemDOM_1.ForItemDOM(this.templateNode);\r\n\t            this.childrenVdom.push(newItem);\r\n\t            var newDom = newItem.transDOM(arr[i], this.forKey, kmv);\r\n\t            docFrag.appendChild(newDom);\r\n\t        }\r\n\t        DomOp.inserBefore(this.nextSibling, docFrag);\r\n\t    };\r\n\t    ForDOM.prototype.addNewItem = function (val, kmv) {\r\n\t        var newItem = new ForItemDOM_1.ForItemDOM(this.templateNode);\r\n\t        var newDom = newItem.transDOM(val, this.forKey, kmv);\r\n\t        this.childrenVdom.push(newItem);\r\n\t        DomOp.inserBefore(this.nextSibling, newDom);\r\n\t    };\r\n\t    ForDOM.prototype.popItem = function () {\r\n\t        var popVdom = this.childrenVdom.pop();\r\n\t        popVdom.$dom && DomOp.removeNode(popVdom.$dom);\r\n\t    };\r\n\t    ForDOM.prototype.changeItem = function (i, kmv) {\r\n\t        this.childrenVdom[i].reRender(this.iteratorData[i], this.forKey, kmv);\r\n\t    };\r\n\t    ForDOM.prototype.shiftItem = function () {\r\n\t        var shiftVdom = this.childrenVdom.shift();\r\n\t        this.childrenVdom.shift();\r\n\t        DomOp.removeNode(shiftVdom.$dom);\r\n\t    };\r\n\t    return ForDOM;\r\n\t}());\r\n\texports.ForDOM = ForDOM;\r\n\n\n/***/ },\n/* 14 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar __extends = (this && this.__extends) || function (d, b) {\r\n\t    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\r\n\t    function __() { this.constructor = d; }\r\n\t    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n\t};\r\n\tvar DomUtil = __webpack_require__(3);\r\n\tvar object_1 = __webpack_require__(2);\r\n\tvar ForNormalDOM_1 = __webpack_require__(15);\r\n\tvar VDOM_1 = __webpack_require__(4);\r\n\tvar ForItemDOM = (function (_super) {\r\n\t    __extends(ForItemDOM, _super);\r\n\t    function ForItemDOM(node) {\r\n\t        var _this = _super.call(this, node) || this;\r\n\t        _this.childrenVdom = [];\r\n\t        for (var i = 0; i < node.childNodes.length; i++) {\r\n\t            var childNode = node.childNodes[i];\r\n\t            _this.childrenVdom.push(new ForNormalDOM_1.ForNormalDOM(childNode));\r\n\t        }\r\n\t        node.removeAttribute(\"k-for\");\r\n\t        _this.tagName = node.tagName;\r\n\t        _this.templateNode = node;\r\n\t        _this.attributes = node.attributes;\r\n\t        _this.nodeType = node.nodeType;\r\n\t        return _this;\r\n\t    }\r\n\t    ForItemDOM.prototype.transDOM = function (iteratorVal, iteratorKey, kmv) {\r\n\t        var data = object_1.depCopy(object_1.getDotVal(kmv.$data, iteratorKey));\r\n\t        data[iteratorKey] = iteratorVal; // 构建迭代对象 eg: obj.i = 100;\r\n\t        var newElem = DomUtil.createElement(this.tagName);\r\n\t        for (var i = 0; i < this.childrenVdom.length; i++) {\r\n\t            kmv.$$data = data;\r\n\t            newElem.appendChild(this.childrenVdom[i].transDOM(kmv));\r\n\t        }\r\n\t        this.$dom = newElem;\r\n\t        this.renderAttr(kmv);\r\n\t        return newElem;\r\n\t    };\r\n\t    // 重新渲染\r\n\t    ForItemDOM.prototype.reRender = function (iteratorVal, iteratorKey, kmv) {\r\n\t        var data = object_1.depCopy(kmv.$data);\r\n\t        data[iteratorKey] = iteratorVal; // 构建迭代对象 eg: obj.i = 100;\r\n\t        kmv.$$data = data;\r\n\t        this.childrenVdom.forEach(function (child) {\r\n\t            child.reRender(kmv);\r\n\t        });\r\n\t        this.renderAttr(kmv);\r\n\t    };\r\n\t    return ForItemDOM;\r\n\t}(VDOM_1.VDOM));\r\n\texports.ForItemDOM = ForItemDOM;\r\n\n\n/***/ },\n/* 15 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar __extends = (this && this.__extends) || function (d, b) {\r\n\t    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\r\n\t    function __() { this.constructor = d; }\r\n\t    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n\t};\r\n\tvar template_1 = __webpack_require__(5);\r\n\tvar DomUtil = __webpack_require__(3);\r\n\tvar constant_1 = __webpack_require__(1);\r\n\tvar VDOM_1 = __webpack_require__(4);\r\n\tvar ForNormalDOM = (function (_super) {\r\n\t    __extends(ForNormalDOM, _super);\r\n\t    function ForNormalDOM(node) {\r\n\t        var _this = _super.call(this, node) || this;\r\n\t        _this.childrenVdom = [];\r\n\t        // h3\r\n\t        _this.tagName = node.tagName, _this.attributes = node.attributes,\r\n\t            _this.nodeType = node.nodeType;\r\n\t        switch (node.nodeType) {\r\n\t            case constant_1.NodeType.TEXT:\r\n\t                _this.template = node.textContent;\r\n\t                break;\r\n\t            case constant_1.NodeType.ELEMENT:\r\n\t                _this.template = node.firstChild.nodeValue;\r\n\t                break;\r\n\t        }\r\n\t        if (node.childNodes) {\r\n\t            for (var i = 0; i < node.childNodes.length; i++) {\r\n\t                var child = node.childNodes[i];\r\n\t                _this.childrenVdom.push(new ForNormalDOM(child));\r\n\t            }\r\n\t        }\r\n\t        return _this;\r\n\t    }\r\n\t    ForNormalDOM.prototype.transDOM = function (kmv) {\r\n\t        var data = kmv.$$data;\r\n\t        var newEle = document.createElement(this.tagName);\r\n\t        switch (this.nodeType) {\r\n\t            case constant_1.NodeType.TEXT:\r\n\t                newEle = DomUtil.createTextNode(this.tagName);\r\n\t                newEle.textContent = template_1.compileTpl(this.template, data);\r\n\t                this.$dom = newEle;\r\n\t                break;\r\n\t            case constant_1.NodeType.ELEMENT:\r\n\t                newEle = document.createElement(this.tagName);\r\n\t                this.$dom = newEle;\r\n\t                this.childrenVdom\r\n\t                    &&\r\n\t                        this.childrenVdom.forEach(function (child) {\r\n\t                            newEle.appendChild(child.transDOM(kmv));\r\n\t                        });\r\n\t                this.renderAttr(kmv);\r\n\t                break;\r\n\t        }\r\n\t        this.renderAttr(kmv);\r\n\t        return newEle;\r\n\t    };\r\n\t    ForNormalDOM.prototype.reRender = function (kmv) {\r\n\t        var data = kmv.$$data; // $$data迭代的每一个对象\r\n\t        var text = template_1.compileTpl(this.template, data);\r\n\t        switch (this.nodeType) {\r\n\t            case constant_1.NodeType.TEXT:\r\n\t                DomUtil.changeTextContent(this.$dom, text);\r\n\t                break;\r\n\t            case constant_1.NodeType.ELEMENT:\r\n\t                this.childrenVdom.forEach(function (child) {\r\n\t                    child.reRender(kmv);\r\n\t                });\r\n\t                break;\r\n\t        }\r\n\t    };\r\n\t    return ForNormalDOM;\r\n\t}(VDOM_1.VDOM));\r\n\texports.ForNormalDOM = ForNormalDOM;\r\n\n\n/***/ },\n/* 16 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar __extends = (this && this.__extends) || function (d, b) {\r\n\t    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\r\n\t    function __() { this.constructor = d; }\r\n\t    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n\t};\r\n\tvar VDOM_1 = __webpack_require__(4);\r\n\tvar object_1 = __webpack_require__(2);\r\n\tvar IfDOM = (function (_super) {\r\n\t    __extends(IfDOM, _super);\r\n\t    function IfDOM(node) {\r\n\t        var _this = _super.call(this, node) || this;\r\n\t        _this.childrenVdom = [];\r\n\t        // h3\r\n\t        _this.tagName = node.tagName, _this.attributes = node.attributes,\r\n\t            _this.nodeType = node.nodeType;\r\n\t        _this.kif = node.getAttribute(\"k-if\");\r\n\t        _this.$dom = node;\r\n\t        node.removeAttribute(\"k-if\");\r\n\t        return _this;\r\n\t    }\r\n\t    IfDOM.prototype.renderInit = function (kmv) {\r\n\t        var data = kmv.$data;\r\n\t        var isShow = object_1.getDotVal(data, this.kif);\r\n\t        if (!!isShow) {\r\n\t            this.$dom.style.display = \"block\";\r\n\t        }\r\n\t        else {\r\n\t            this.$dom.style.display = \"none\";\r\n\t        }\r\n\t    };\r\n\t    IfDOM.prototype.reRender = function (kmv) {\r\n\t        var data = kmv.$data;\r\n\t        var isShow = object_1.getDotVal(data, this.kif);\r\n\t        if (!!isShow) {\r\n\t            this.$dom.style.display = \"block\";\r\n\t        }\r\n\t        else {\r\n\t            this.$dom.style.display = \"none\";\r\n\t        }\r\n\t    };\r\n\t    return IfDOM;\r\n\t}(VDOM_1.VDOM));\r\n\texports.IfDOM = IfDOM;\r\n\n\n/***/ },\n/* 17 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar object_1 = __webpack_require__(2);\r\n\tvar InputDOM = (function () {\r\n\t    function InputDOM(node) {\r\n\t        this.childrenVdom = [];\r\n\t        // h3\r\n\t        this.tagName = node.tagName, this.attributes = node.attributes,\r\n\t            this.nodeType = node.nodeType;\r\n\t        this.kmodel = node.getAttribute(\"k-model\");\r\n\t        this.$dom = node;\r\n\t        node.removeAttribute(\"k-model\");\r\n\t    }\r\n\t    InputDOM.prototype.renderInit = function (kmv) {\r\n\t        var _this = this;\r\n\t        var data = kmv.$data;\r\n\t        this.$dom.value = object_1.getDotVal(data, this.kmodel);\r\n\t        this.$dom.oninput = function (ev) {\r\n\t            object_1.setObserveDotVal(kmv.data, _this.kmodel, _this.$dom.value);\r\n\t        };\r\n\t    };\r\n\t    InputDOM.prototype.reRender = function (kmv) {\r\n\t        var data = kmv.$data;\r\n\t        var text = object_1.getDotVal(data, this.kmodel);\r\n\t        this.$dom.value = text;\r\n\t    };\r\n\t    return InputDOM;\r\n\t}());\r\n\texports.InputDOM = InputDOM;\r\n\n\n/***/ },\n/* 18 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar __extends = (this && this.__extends) || function (d, b) {\r\n\t    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\r\n\t    function __() { this.constructor = d; }\r\n\t    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n\t};\r\n\tvar template_1 = __webpack_require__(5);\r\n\tvar DomUtil = __webpack_require__(3);\r\n\tvar constant_1 = __webpack_require__(1);\r\n\tvar VDOM_1 = __webpack_require__(4);\r\n\tvar NormalDOM = (function (_super) {\r\n\t    __extends(NormalDOM, _super);\r\n\t    function NormalDOM(node) {\r\n\t        var _this = _super.call(this, node) || this;\r\n\t        _this.childrenVdom = [];\r\n\t        // h3\r\n\t        _this.tagName = node.tagName,\r\n\t            _this.attributes = node.attributes && ([].slice.call(node.attributes).slice(0)),\r\n\t            _this.nodeType = node.nodeType;\r\n\t        _this.$dom = node;\r\n\t        switch (node.nodeType) {\r\n\t            case constant_1.NodeType.TEXT:\r\n\t                _this.template = node.textContent;\r\n\t                break;\r\n\t            case constant_1.NodeType.ELEMENT:\r\n\t                _this.template = node.firstChild.nodeValue;\r\n\t                break;\r\n\t        }\r\n\t        if (node.childNodes) {\r\n\t            for (var i = 0; i < node.childNodes.length; i++) {\r\n\t                var child = node.childNodes[i];\r\n\t                _this.childrenVdom.push(new NormalDOM(child));\r\n\t            }\r\n\t        }\r\n\t        return _this;\r\n\t    }\r\n\t    NormalDOM.prototype.renderInit = function (kmv) {\r\n\t        var data = kmv.$data;\r\n\t        switch (this.nodeType) {\r\n\t            case constant_1.NodeType.TEXT:\r\n\t                DomUtil.changeTextContent(this.$dom, template_1.compileTpl(this.template, data));\r\n\t                break;\r\n\t            case constant_1.NodeType.ELEMENT:\r\n\t                this.childrenVdom.forEach(function (child) {\r\n\t                    child.renderInit(kmv);\r\n\t                });\r\n\t                this.renderAttr(kmv);\r\n\t                break;\r\n\t        }\r\n\t    };\r\n\t    NormalDOM.prototype.reRender = function (kmv) {\r\n\t        var data = kmv.$data;\r\n\t        var text = template_1.compileTpl(this.template, data);\r\n\t        switch (this.nodeType) {\r\n\t            case constant_1.NodeType.TEXT:\r\n\t                DomUtil.changeTextContent(this.$dom, text);\r\n\t                break;\r\n\t            case constant_1.NodeType.ELEMENT:\r\n\t                this.childrenVdom.forEach(function (child) {\r\n\t                    child.reRender(kmv);\r\n\t                });\r\n\t                this.reRenderAttr(kmv);\r\n\t                break;\r\n\t        }\r\n\t    };\r\n\t    return NormalDOM;\r\n\t}(VDOM_1.VDOM));\r\n\texports.NormalDOM = NormalDOM;\r\n\n\n/***/ }\n/******/ ]);\n\n\n// WEBPACK FOOTER //\n// bundle.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 45eac28ab7ceeabdd008","import { renderInit } from './util/render'\r\nimport { observer } from './util/observer'\r\nimport { RenderQueue } from \"./util/RenderQueue\"\r\n\r\nfunction Kmv(opts) {\r\n\r\n    let elSelector = opts['el'];\r\n    let elem = document.querySelector(elSelector);\r\n    this.data = opts.data;\r\n    // 获取需要渲染的dom列表\r\n    this.renderQueue = new RenderQueue(elem);\r\n    // 原始数据\r\n    this.$data = observer(opts.data, this);\r\n    this.watch = opts.watch || {};\r\n\r\n    this.pendingValue = false;\r\n    this.pendingArray = false;\r\n\r\n    this.circle = {};\r\n\r\n    this.changeQueue = [];\r\n\r\n    this.methods = opts.methods;\r\n    renderInit(this);\r\n    return this;\r\n}\r\n\r\n(<any>window).Kmv = Kmv;\r\n\r\nexport default Kmv;\r\n\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.ts","/**\r\n *   URL:\r\n *   说明:\r\n *   负责人: kelen\r\n *   日期:  1/24 0024.\r\n */\r\nexport const Attr = {\r\n    K_MODEL: 'k-model'\r\n}\r\n\r\nexport const RegexpStr = {\r\n    brace: /\\{\\{((?:.|\\n)+?)\\}\\}/,  // {{ name }}  大括号\r\n    forStatement: /([a-z_]+[\\w]*)\\s+in\\s+([a-z_][\\w.]+)/,\r\n    bracket: /\\[['|\"]?(\\w+)['|\"]?\\]/,   // 中括号\r\n    isString: /'([^']*)'|\"([^\\\"]*)\"/,\r\n    isParams: /^[^\"|^'\\d]+.*/,\r\n    arithmeticOp: /\\*|\\+|-\\/|\\(|\\)/g,          // 逻辑运算符\r\n    inputElement: /INPUT|TEXTAREA/,\r\n    arrtibuteKey: /k-for|k-model|k-if|k:.*|k-on:(.*)/,\r\n    kAttribute: /k:(.*)/,\r\n    kOnAttribute: /k-on:(.*)/,\r\n    methodAndParam: /([a-zA-Z\\d_]+)\\((.*)\\)/,\r\n    isTernaryOp: /!.*|!!.*|.+?.+:.+/,\r\n    ternaryOpSplit: /\\?|:|\\(|\\)|!!/        // 正则切割\r\n}\r\n\r\nexport const NodeType = {\r\n    ELEMENT: 1,\r\n    ATTRIBUTE: 2,\r\n    TEXT: 3,\r\n    COMMENT: 8,\r\n    DOCUMENT: 9\r\n}\r\n\r\nexport const ArrayMethod = ['push', 'pop', 'splice', 'shift', 'unshift', 'sort', 'reverse']\r\n\r\nexport enum RenderType {\r\n    TEXT, INPUT, TEXTAREA, FOR, IF, ATTRIBUTE\r\n}\r\n\r\nexport enum ArrayOp {\r\n    PUSH, POP, SORT, CHANGE, SHIFT\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/constants/constant.ts","\r\nimport { RegexpStr } from '../constants/constant';\r\n\r\nexport let getDotVal = (obj, key) => {\r\n    let val, k;\r\n\r\n    if (key) {\r\n\r\n        key = key.replace(RegexpStr.bracket, \".$1\");\t\t// 把arr['name']/arr[\"name\"]/arr[0] 转为 arr.name/arr.0\r\n\r\n        val = obj;\r\n        // 获取对应的dot值\r\n        let arr = key.split(\".\") || [key];\r\n        while (k = arr.shift()) {\r\n            if (!val) {\r\n                val = undefined;\r\n                break;\r\n            }\r\n            val = val[k];\r\n        }\r\n\r\n    }\r\n\r\n    return val;\r\n}\r\n\r\nexport let depCopy = (obj) => {\r\n    let newObj = {};\r\n    for (let i in obj) {\r\n        if (typeof obj[i] === 'object') {\r\n            if (Array.isArray(obj[i])) {\r\n                newObj[i] = obj[i].slice(0);\r\n            } else {\r\n                newObj[i] = depCopy(obj[i]);\r\n            }\r\n        } else {\r\n            newObj[i] = obj[i];\r\n        }\r\n    }\r\n    return newObj;\r\n}\r\n\r\n\r\nexport let setObserveDotVal = (observeData, key, val) => {\r\n    key = key.replace(RegexpStr.bracket, \".$1\");\t\t// 把arr['name']/arr[\"name\"]/arr[0] 转为 arr.name/arr.0\r\n    let tmp = observeData;\r\n    let arr = key.split(\".\");\r\n    let len = arr.length;\r\n    for (let i = 0; i < len - 1; i++) {\r\n        tmp = tmp[arr[i]];\r\n    }\r\n\r\n    tmp[arr[len - 1]] = val;\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/util/object.ts","/**\r\n * Created by kelen on 2017/2/6.\r\n */\r\nimport { RegexpStr } from '../constants/constant'\r\nimport { compileTpl } from '../util/template'\r\nimport { isKvmAttribute } from '../util/validator'\r\nimport { bindEvent } from \"./event\";\r\n\r\nexport let insertAfter = (node, newNode) => {\r\n    node && node.parentNode && node.parentNode.insertBefore(newNode, node.nextSibling);\r\n}\r\n\r\nexport let createTextNode = (text) => {\r\n    return document.createTextNode(text);\r\n}\r\n\r\nexport let createElement = (tagName) => {\r\n    return document.createElement(tagName);\r\n}\r\n\r\nexport let inserBefore = (node, newNode) => {\r\n    node && node.parentNode && node.parentNode.insertBefore(newNode, node);\r\n}\r\n\r\nexport let deleteNode = (parent, node) => {\r\n    parent && node && parent.removeChild(node);\r\n}\r\n\r\nexport let changeNodeValue = (node, text) => {\r\n    node && node.firstChild && (node.firstChild.nodeValue = text);\r\n}\r\n\r\nexport let changeTextContent = (textNode, text) => {\r\n    textNode && (textNode.textContent = text);\r\n}\r\n\r\nexport let removeAttribute = (node, attr) => {\r\n    node && node.removeAttribute(attr);\r\n}\r\n\r\nexport let findIteratorNode = (parentNode, key) => {\r\n    let childrens = parentNode.childNodes;\r\n    let iteratorNodes = [];\r\n    for (let i = 0; i < childrens.length; i++) {\r\n        let node = childrens[i];\r\n        if (node.forString && node.forKey && node.forKey == key) {\r\n            iteratorNodes.push(node);\r\n        }\r\n        if (node.childNodes.length) {\r\n            iteratorNodes.concat(findIteratorNode(node, key));\r\n        }\r\n    }\r\n    return iteratorNodes;\r\n}\r\n\r\nexport let hideNode = (node) => {\r\n    node.style.display = \"none\";\r\n}\r\n\r\nexport let showNode = (node) => {\r\n    node.style.display = \"block\";\r\n}\r\n\r\nexport let removeNode = (node) => {\r\n    node && node.parentNode.removeChild(node);\r\n}\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/dom/domOp.ts","import { compileTpl } from '../util/template'\r\nimport { NodeType } from \"../constants/constant\"\r\nimport { isKvmAttribute } from '../util/validator'\r\nimport { RegexpStr } from '../constants/constant'\r\nimport { bindEvent } from \"../dom/event\"\r\nimport {getDotVal} from \"../util/object\";\r\n\r\nexport class VDOM {\r\n    nodeType;\r\n    $dom;\r\n    attributes;\r\n    vdomAttr = {};\r\n    constructor (node) {\r\n        node.attributes && (this.attributes = [].slice.call(node.attributes).slice(0));\r\n    }\r\n    renderAttr (kmv) {\r\n        if (this.nodeType === NodeType.ELEMENT) {\r\n            let data = kmv.$data;\r\n            let node = this.$dom;\r\n            let attrs = this.attributes;\r\n            console.log(attrs);\r\n            for (let i = 0; i < attrs.length; i++) {\r\n                let attr = attrs[i];\r\n                let attrName = attr.nodeName, attrVal = attr.nodeValue;\r\n                if (RegexpStr.kAttribute.test(attrName)) {\r\n                    let key = attr.nodeName.replace(RegexpStr.kAttribute, '$1');\r\n                    if (key === 'class') {\r\n                        // 类 a:'class2', b:'class2'\r\n                        let arr = attrVal.split(\",\");\r\n                        let valRes = \"\";\r\n                        for (var n = 0; n < arr.length; n++) {\r\n                            var ak = arr[n].split(\":\")[0];\r\n                            if (getDotVal(data, ak.trim())) {\r\n                                valRes += arr[n].split(\":\")[1].trim() + \" \";\r\n                            }\r\n                        }\r\n                        node.setAttribute(key, valRes.trim());\r\n                        node.removeAttribute(attrName);\r\n                    } else {\r\n                        let val = getDotVal(data, attrVal);\r\n                        node.setAttribute(key, val);\r\n                        node.removeAttribute(attrName);\r\n                    }\r\n                } else if (RegexpStr.kOnAttribute.test(attrName)) {\r\n                    let event = attrName.replace(RegexpStr.kOnAttribute, '$1');\r\n                    let func = compileTpl(attrVal, data);\r\n                    let match = func.match(RegexpStr.methodAndParam);\r\n                    let method = match[1];\r\n                    let params = match[2];\r\n                    bindEvent(node, event, method, params, kmv.methods, kmv.data);\r\n                    node.removeAttribute(attrName);\r\n                } else {\r\n                    node.setAttribute(attrName, attrVal);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    reRenderAttr (kmv) {\r\n        if (this.nodeType === NodeType.ELEMENT) {\r\n            let data = kmv.data;\r\n            let node = this.$dom;\r\n            for (let i = 0; i < this.attributes.length; i++) {\r\n                let attr = this.attributes[i];\r\n                let attrName = attr.nodeName, attrVal = attr.nodeValue;\r\n                if (isKvmAttribute(attrName)) {\r\n                    if (RegexpStr.kAttribute.test(attrName)) {\r\n                        let key = attr.nodeName.replace(RegexpStr.kAttribute, '$1');\r\n                        if (key === 'class') {\r\n                            // 类 a:'class2', b:'class2'\r\n                            let arr = attrVal.split(\",\");\r\n                            let valRes = \"\";\r\n                            for (var n = 0; n < arr.length; n++) {\r\n                                var ak = arr[n].split(\":\")[0];\r\n                                if (getDotVal(data, ak.trim())) {\r\n                                    valRes += arr[n].split(\":\")[1].trim() + \" \";\r\n                                }\r\n                            }\r\n                            node.setAttribute(key, valRes.trim());\r\n                            node.removeAttribute(attrName);\r\n                        } else {\r\n                            let val = getDotVal(data, attrVal);\r\n                            node.setAttribute(key, val);\r\n                            node.removeAttribute(attrName);\r\n                        }\r\n                    } else if (RegexpStr.kOnAttribute.test(attrName)) {\r\n                        let event = attrName.replace(RegexpStr.kOnAttribute, '$1');\r\n                        let func = compileTpl(attrVal, data);\r\n                        let match = func.match(RegexpStr.methodAndParam);\r\n                        let method = match[1];\r\n                        let params = match[2];\r\n                        bindEvent(node, event, method, params, kmv.methods, kmv.data);\r\n                        node.removeAttribute(attrName);\r\n                    } else {\r\n                        node.setAttribute(attrName, compileTpl(attrVal, data));\r\n                    }\r\n                } else {\r\n                    node.setAttribute(attrName, attrVal);\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/vdom/VDOM.ts","import { RegexpStr } from '../constants/constant'\r\nimport { getDotVal, depCopy } from './object'\r\nimport { evalJs } from './function'\r\n/**\r\n *  转换逻辑操作运算结果\r\n *\r\n */\r\nexport let transArithmeticOp = (tpl, obj) => {\r\n\r\n    let opReg = RegexpStr.arithmeticOp;\r\n    let arr = tpl.split(opReg);   // 符号切分\r\n    let opRegArr = tpl.match(opReg);\r\n    let isParamReg = RegexpStr.isParams;\r\n\r\n    let tmp;\r\n    let newStr = '';\r\n\r\n    for (let i = 0; i < arr.length; i++) {\r\n        tmp = arr[i].trim();\r\n        if (isParamReg.test(tmp)) {\r\n            // 如果是变量\r\n            let val = getDotVal(obj, tmp);\r\n            if (isNaN(val)) {       // 字符串\r\n                newStr += '\"' + val + '\"';\r\n            } else {\r\n                if (!val) val = 0;\r\n                newStr += val;\r\n            }\r\n        } else {\r\n            newStr += tmp;\r\n        }\r\n\r\n        if (i < arr.length - 1) {\r\n            newStr += opRegArr[i];\r\n        }\r\n    }\r\n    let res = eval(newStr);\r\n    return res;\r\n}\r\n\r\nexport let transTernaryOperator = (tpl, obj) => {\r\n    let arr = tpl.split(/\\?|:|\\(|\\)|\\+|-|\\*|\\/|!/);\r\n    let match = tpl.match(/\\?|:|\\(|\\)|\\+|-|\\*|\\/|!/g);\r\n\r\n    let newStr = '';\r\n    for (let i = 0; i < arr.length; i++) {\r\n        let item = arr[i].trim();\r\n        if (item && RegexpStr.isParams.test(item)) {\r\n            newStr += '_data.' + item;\r\n        } else {\r\n            newStr += item;\r\n        }\r\n        if (match[i])\r\n            newStr += match[i];\r\n    }\r\n    return (function(str, _data) {\r\n        return eval(str);\r\n    })(newStr, obj)\r\n}\r\n\r\nexport let compileTpl = (tpl, obj) => {\r\n    let braceReg = RegexpStr.brace;\r\n    var regRes;\r\n    while (regRes = braceReg.exec(tpl)) {\r\n        let key = regRes ? regRes[1].trim() : '';\t// 获取括号的键\r\n        if (key) {\r\n            let text = evalJs(key, obj);\r\n            tpl = tpl.replace(braceReg, text);\r\n        } else {\r\n            return '';\r\n        }\r\n    }\r\n    /*var regRes;\r\n    while (regRes = braceReg.exec(tpl)) {\r\n        let key = regRes ? regRes[1].trim() : '';\t// 获取括号的键\r\n        let opReg = RegexpStr.arithmeticOp;     // 是否有操作符\r\n        let text = '';\r\n        if (key) {\r\n            if (opReg.test(key)) {\r\n                text = transArithmeticOp(key, obj);\r\n            } else if (RegexpStr.isTernaryOp.test(key)) {\r\n                text = transTernaryOperator(key, obj);\r\n            } else {\r\n                text = getDotVal(obj, key);\r\n            }\r\n            tpl = tpl.replace(braceReg, text);\r\n        } else {\r\n            return '';\r\n        }\r\n    }*/\r\n    return tpl;\r\n}\r\n\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/util/template.ts","export let bindEvent = (node, event, method, param = '', methodsObj, observeData) => {\r\n\r\n    if (node.addEventListener) {\r\n        node.addEventListener(event, function() {\r\n            let params = param.split(',');\r\n            methodsObj[method].apply(observeData, params);\r\n        });\r\n    } else {\r\n        node.attachEvent(\"on\" + event, function() {\r\n            let params = param.split(',');\r\n            methodsObj[method].apply(observeData, params);\r\n        })\r\n    }\r\n\r\n\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/dom/event.ts","import { NodeType, RegexpStr, RenderType } from '../constants/constant'\r\nimport { ForDOM } from \"../vdom/ForDOM\"\r\nimport {NormalDOM} from \"../vdom/NormalDOM\";\r\nimport {InputDOM} from \"../vdom/InputDOM\";\r\nimport {IfDOM} from \"../vdom/IfDOM\";\r\n\r\nexport class RenderQueue {\r\n    queue = [];\r\n    constructor(node) {\r\n        this.queue = this.queueInit(node);\r\n    }\r\n    getQueue() {\r\n        return this.queue;\r\n    }\r\n    queueInit (parentNode) {\r\n        let childNodes = parentNode.childNodes;\r\n        for (let i = 0; i < childNodes.length; i++) {\r\n            let child = childNodes[i];\r\n            switch (child.nodeType) {\r\n                case NodeType.TEXT:\r\n                    this.queue.push(new NormalDOM(child));\r\n                    break;\r\n                case NodeType.ELEMENT:\r\n                    if (child.getAttribute(\"k-for\")) {\r\n                        this.queue.push(new ForDOM(child));\r\n                    } else if (child.getAttribute(\"k-model\") && RegexpStr.inputElement.test(child.tagName)) {\r\n                        this.queue.push(new InputDOM(child));\r\n                    } else if (child.getAttribute(\"k-if\")) {\r\n                        this.queue.push(new IfDOM(child));\r\n                    } else {\r\n                        this.queue.push(new NormalDOM(child));\r\n                    }\r\n                    break;\r\n            }\r\n        }\r\n        return this.queue;\r\n    }\r\n}\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/util/RenderQueue.ts","import { ArrayOp } from \"../constants/constant\"\r\n\r\nexport let diff = (arr1 = [], arr2 = []) => {\r\n    let change = [];\r\n    let len1 = arr1.length, len2 = arr2.length;\r\n    let len = Math.min(len1, len2);\r\n    for (let i = 0; i < len; i++) {\r\n        if (arr1[i] !== arr2[i]) {\r\n            change.push({\r\n                op: ArrayOp.CHANGE,\r\n                index: i,\r\n                text: arr2[i]\r\n            })\r\n        }\r\n    }\r\n    if (len1 > len2) {\r\n        let deleteArr = arr1.slice(len2);\r\n        // 删除dom\r\n        for (let i = 0; i < deleteArr.length; i++) {\r\n            change.push({\r\n                op: ArrayOp.POP,\r\n                index: i + len2,\r\n                text: deleteArr[i]\r\n            })\r\n        }\r\n    } else {\r\n        let addArr = arr2.slice(len1);\r\n        change.push({\r\n            batch: true,\r\n            op: ArrayOp.PUSH,\r\n            array: addArr\r\n        })\r\n    }\r\n    return change;\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/util/array.ts","export let evalJs = (content, obj) => {\r\n    // console.dir(obj);\r\n    // return (function() { return eval(content) }).call(obj);\r\n    return new Function(\"with(this){ return \" + content + \" }\").call(obj);\r\n}\r\n\r\nexport let evalFunc = (code) => {\r\n    return new Function(\"with(this){ console.log(this); return \" + code + \" }\");\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/util/function.ts","import * as ObjectUtil from '../util/object'\r\nimport { reRender, reRenderFor } from \"./render\";\r\nimport { ArrayMethod } from '../constants/constant'\r\nimport {getDotVal} from \"./object\";\r\n/**\r\n *   URL:\r\n *   说明:\r\n *   负责人: kelen\r\n *   日期:  1/24 0024.\r\n */\r\nexport let observer = (obj, kmv, key = '') => {\r\n    let newObj = ObjectUtil.depCopy(obj);\r\n    for (let i in obj) {\r\n        let bigKey = key ? key + \".\" + i : i;\r\n        if (typeof obj[i] == 'object') {\r\n            if (Array.isArray(obj[i])) {\r\n                arrayObserve(obj[i], kmv, bigKey);\r\n            } else {\r\n                observer(obj[i], kmv, bigKey);\r\n            }\r\n        } else {\r\n            Object.defineProperty(obj, i, {\r\n                set: function (newVal) {\r\n                    ObjectUtil.setObserveDotVal(kmv.$data, bigKey, newVal);\r\n                    kmv.pendingValue = true;\r\n                    kmv.changeQueue.push({\r\n                        kmv: kmv,\r\n                        bigKey: bigKey\r\n                    });\r\n                    kmv.watch[bigKey] && kmv.watch[bigKey].call(kmv.data, newVal);\r\n                },\r\n                get: function() {\r\n                    return getDotVal(kmv.$data, bigKey);\r\n                }\r\n            })\r\n        }\r\n    }\r\n    return newObj;\r\n}\r\n\r\nfunction arrayObserve(arr, kmv, bigKey) {\r\n\r\n    // 监听array操作\r\n    ArrayMethod.forEach((method) => {\r\n        Object.defineProperty(arr, method, {\r\n            configurable: false,\r\n            enumerable: false, // hide from for...in\r\n            writable: false,\r\n            value: function () {\r\n                Array.prototype[method].apply(getDotVal(kmv.$data, bigKey), arguments);\r\n                kmv.changeQueue.push({\r\n                    kmv: kmv,\r\n                    bigKey: bigKey\r\n                });\r\n                kmv.pendingArray = true;\r\n                // reRenderFor(kmv, bigKey);\r\n            }\r\n        });\r\n    })\r\n}\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/util/observer.ts","import { RenderType } from '../constants/constant'\r\nimport { getDotVal } from './object'\r\nimport { diff } from \"./array\";\r\n\r\nexport let renderInit = (kmv) => {\r\n    let watcher = kmv.renderQueue;\r\n    let renderQueue = watcher.getQueue();\r\n    for (let i = 0; i < renderQueue.length; i++) {\r\n        let node = renderQueue[i];\r\n        node.renderInit(kmv);\r\n    }\r\n    nextTick(kmv);\r\n}\r\n\r\nexport let nextTick = (kmv) => {\r\n    setTimeout(function() {\r\n        if (kmv.pendingValue) {\r\n            console.log(\"reRender\");\r\n            kmv.pendingValue = false;\r\n            let lastOne = kmv.changeQueue.pop();\r\n            reRender(lastOne.kmv, lastOne.bigKey);\r\n            kmv.changeQueue.length = 0;\r\n        }\r\n        if (kmv.pendingArray) {\r\n            console.log(\"reRenderFor\")\r\n            kmv.pendingArray = false;\r\n            let lastOne = kmv.changeQueue.pop();\r\n            reRenderFor(lastOne.kmv, lastOne.bigKey);\r\n            kmv.changeQueue.length = 0;\r\n        }\r\n        // 下一次事件循环\r\n        nextTick(kmv);\r\n    }, 0);\r\n}\r\n\r\nexport let reRender = (kmv, key) => {\r\n    let renderQueue = kmv.renderQueue.getQueue();\r\n    for (let i = 0; i < renderQueue.length; i++) {\r\n        let node = renderQueue[i];\r\n        node.reRender(kmv);\r\n    }\r\n}\r\n\r\nexport let reRenderFor = (kmv, forKey) => {\r\n    let renderQueue = kmv.renderQueue.getQueue();\r\n    let data = kmv.$data;\r\n    for (let i = 0; i < renderQueue.length; i++) {\r\n        let vnode = renderQueue[i];\r\n        if (vnode.renderType == RenderType.FOR) {\r\n            let arrKey = vnode.forObjectKey;\r\n            let newArray = getDotVal(data, arrKey);\r\n            if (Array.isArray(newArray)) {\r\n                let change = diff(vnode.iteratorData, newArray);\r\n                vnode.notifyDataChange(change, kmv);\r\n            } else {\r\n                vnode.notifyDataChange(null, kmv);\r\n            }\r\n        }\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/util/render.ts","import { RegexpStr } from '../constants/constant'\r\n\r\nlet isBraceReg = (str: string) => {\r\n    return RegexpStr.brace.test(str);\r\n}\r\n\r\n/**\r\n *  是否有包含语法\r\n * @param str\r\n */\r\nlet isForStatement = (str: string) => {\r\n    return RegexpStr.forStatement.test(str);\r\n}\r\n\r\nlet validator =  {\r\n    isBraceReg: isBraceReg,\r\n    isForStatement: isForStatement\r\n}\r\n\r\nexport let isKvmAttribute = (key) => {\r\n    return RegexpStr.arrtibuteKey.test(key);\r\n}\r\n\r\nexport default validator;\n\n\n// WEBPACK FOOTER //\n// ./src/util/validator.ts","import { ForItemDOM } from './ForItemDOM'\r\nimport {RegexpStr, ArrayOp, RenderType} from '../constants/constant'\r\nimport { getDotVal } from \"../util/object\"\r\nimport * as DomOp from \"../dom/domOp\"\r\n\r\nexport class ForDOM {\r\n    previousSibling;    // 前一个元素\r\n    nextSibling;        // 后一个元素\r\n    templateNode;       // 模板节点\r\n    childrenVdom = [];\r\n    $nextSibling;\r\n    renderType = RenderType.FOR;\r\n    forString;      // i in arr\r\n    forObjectKey;   // arr\r\n    forKey;         // i\r\n    tagName;\r\n    iteratorData;\r\n    $dom;           // 对应的真实dom\r\n    constructor (node) {\r\n        this.previousSibling = node.previousSibling;\r\n        this.nextSibling = node.nextSibling;\r\n        this.templateNode = node;\r\n        this.connect(node.previousElementSibling, node.nextElementSibling);\r\n        let forString = node.getAttribute(\"k-for\");\r\n        let match = RegexpStr.forStatement.exec(forString);\r\n        this.tagName = node.tagName;\r\n        this.forString = forString;\r\n        this.forObjectKey = match[2].trim();\r\n        this.forKey = match[1].trim();\r\n        DomOp.removeNode(node);\r\n    }\r\n    renderInit(kmv) {\r\n        let iteratorData = getDotVal(kmv.$data, this.forObjectKey);\r\n        let docFrag = document.createDocumentFragment();\r\n        if (Array.isArray(iteratorData)) {\r\n            this.iteratorData = iteratorData.slice(0);\r\n            for (let i = 0; i < this.iteratorData.length; i++) {\r\n                let forItem = new ForItemDOM(this.templateNode);\r\n                this.childrenVdom.push(forItem);\r\n                let forItemDom = forItem.transDOM(this.iteratorData[i], this.forKey, kmv);\r\n                docFrag.appendChild(forItemDom);\r\n            }\r\n            DomOp.insertAfter(this.previousSibling, docFrag);\r\n        } else if (typeof iteratorData === 'object') {\r\n            this.iteratorData = iteratorData;\r\n            for (let i in iteratorData) {\r\n                let forItem = new ForItemDOM(this.templateNode);\r\n                this.childrenVdom.push(forItem);\r\n                let forItemDom = forItem.transDOM(iteratorData[i], this.forKey, kmv);\r\n                docFrag.appendChild(forItemDom);\r\n            }\r\n            DomOp.insertAfter(this.previousSibling, docFrag);\r\n        }\r\n        this.connect(this.previousSibling, this.nextSibling);\r\n    }\r\n    connect (realPrevDom, realNextDom) {\r\n        realPrevDom && (realPrevDom.$nextSibling = this);\r\n        this.$nextSibling = realNextDom;\r\n    }\r\n    reRender (kmv) {\r\n        if (Array.isArray(this.iteratorData)) {\r\n            for (let i = 0, len = this.iteratorData.length; i < len; i++) {\r\n                this.childrenVdom[i].reRender(this.iteratorData[i], this.forKey, kmv);\r\n            }\r\n        } else {\r\n            // 渲染对象\r\n            let idx = 0;\r\n            for (let key in this.iteratorData) {\r\n                this.childrenVdom[idx].reRender(this.iteratorData[key], this.forKey, kmv);\r\n                idx++;\r\n            }\r\n        }\r\n    }\r\n    notifyDataChange (change, kmv) {\r\n        let data = kmv.$data;\r\n        let arrKey = this.forObjectKey;\r\n        let arrayData = getDotVal(data, arrKey) || [];\r\n        if (Array.isArray(this.iteratorData)) {\r\n            this.iteratorData = arrayData.slice(0);\r\n            for (let i = 0; i < change.length; i++) {\r\n                var op = change[i].op;\r\n                if (change[i].batch) {\r\n                    switch (op) {\r\n                        case ArrayOp.PUSH:\r\n                            this.batchAdd(change[i].array, kmv);\r\n                            break;\r\n                    }\r\n                } else {\r\n                    switch (op) {\r\n                        case ArrayOp.PUSH:\r\n                            this.addNewItem(change[i].text, kmv);\r\n                            break;\r\n                        case ArrayOp.POP:\r\n                            this.popItem();\r\n                            break;\r\n                        case ArrayOp.CHANGE:\r\n                            this.changeItem (change[i].index, kmv)\r\n                            break\r\n                        case ArrayOp.SHIFT:\r\n                            this.shiftItem();\r\n                            break;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    batchAdd (arr = [], kmv) {\r\n        let docFrag = document.createDocumentFragment();\r\n        for (var i = 0, len = arr.length; i < len; i++) {\r\n            let newItem = new ForItemDOM(this.templateNode);\r\n            this.childrenVdom.push(newItem);\r\n            let newDom = newItem.transDOM(arr[i], this.forKey, kmv);\r\n            docFrag.appendChild(newDom);\r\n        }\r\n        DomOp.inserBefore(this.nextSibling, docFrag);\r\n    }\r\n    addNewItem (val, kmv) {\r\n        let newItem = new ForItemDOM(this.templateNode);\r\n        let newDom = newItem.transDOM(val, this.forKey, kmv);\r\n        this.childrenVdom.push(newItem);\r\n        DomOp.inserBefore(this.nextSibling, newDom);\r\n    }\r\n    popItem () {\r\n        let popVdom = this.childrenVdom.pop();\r\n        popVdom.$dom && DomOp.removeNode(popVdom.$dom);\r\n    }\r\n    changeItem (i, kmv) {\r\n        this.childrenVdom[i].reRender(this.iteratorData[i], this.forKey, kmv);\r\n    }\r\n    shiftItem () {\r\n        let shiftVdom = this.childrenVdom.shift();\r\n        this.childrenVdom.shift();\r\n        DomOp.removeNode(shiftVdom.$dom);\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/vdom/ForDOM.ts","import * as DomUtil from \"../dom/domOp\"\r\nimport {depCopy, getDotVal} from '../util/object'\r\nimport { ForNormalDOM } from './ForNormalDOM'\r\nimport { VDOM } from './VDOM'\r\n\r\nexport class ForItemDOM extends VDOM {\r\n    renderType;\r\n    methods;\r\n    tagName;\r\n    templateNode;\r\n    previousSibling;\r\n    nextSibling;\r\n    nextElementSibling;\r\n    previousElementSibling;\r\n    childrenVdom = [];\r\n    arrayData;\r\n    attributes;\r\n    $nextSibling;       // 链接真实虚拟dom的\r\n    $dom;\r\n    template;\r\n    nodeType;\r\n    constructor (node) {\r\n        super(node);\r\n        for (let i = 0; i < node.childNodes.length; i++) {\r\n            let childNode = node.childNodes[i];\r\n            this.childrenVdom.push(new ForNormalDOM(childNode));\r\n        }\r\n        node.removeAttribute(\"k-for\");\r\n        this.tagName = node.tagName;\r\n        this.templateNode = node;\r\n        this.attributes = node.attributes;\r\n        this.nodeType = node.nodeType;\r\n    }\r\n    transDOM(iteratorVal, iteratorKey, kmv) {\r\n        let data = depCopy(getDotVal(kmv.$data, iteratorKey));\r\n        data[iteratorKey] = iteratorVal;         // 构建迭代对象 eg: obj.i = 100;\r\n        let newElem = DomUtil.createElement(this.tagName);\r\n        for (let i = 0; i < this.childrenVdom.length; i++) {\r\n            kmv.$$data = data;\r\n            newElem.appendChild(this.childrenVdom[i].transDOM(kmv));\r\n        }\r\n        this.$dom = newElem;\r\n        this.renderAttr(kmv);\r\n        return newElem;\r\n    }\r\n    // 重新渲染\r\n    reRender (iteratorVal, iteratorKey, kmv) {\r\n        let data = depCopy(kmv.$data);\r\n        data[iteratorKey] = iteratorVal;         // 构建迭代对象 eg: obj.i = 100;\r\n        kmv.$$data = data;\r\n        this.childrenVdom.forEach((child) => {\r\n            child.reRender(kmv);\r\n        });\r\n        this.renderAttr(kmv);\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/vdom/ForItemDOM.ts","import { compileTpl } from '../util/template'\r\nimport * as DomUtil from '../dom/domOp'\r\nimport { NodeType } from \"../constants/constant\"\r\nimport { isKvmAttribute } from '../util/validator'\r\nimport { RegexpStr } from '../constants/constant'\r\nimport { bindEvent } from \"../dom/event\"\r\nimport { VDOM } from \"./VDOM\";\r\n\r\nexport class ForNormalDOM extends VDOM {\r\n    methods;\r\n    nodeType;\r\n    tagName;\r\n    attributes;\r\n    template;\r\n    childrenVdom = [];\r\n    $dom;       // 联系真实dom\r\n    constructor (node) {\r\n        super(node);\r\n        // h3\r\n        this.tagName = node.tagName, this.attributes = node.attributes,\r\n        this.nodeType = node.nodeType\r\n        switch (node.nodeType) {\r\n            case NodeType.TEXT:\r\n                this.template = node.textContent;\r\n                break;\r\n            case NodeType.ELEMENT:\r\n                this.template = node.firstChild.nodeValue;\r\n                break;\r\n        }\r\n        if (node.childNodes) {\r\n            for (let i = 0; i < node.childNodes.length; i++) {\r\n                let child = node.childNodes[i];\r\n                this.childrenVdom.push(new ForNormalDOM(child))\r\n            }\r\n        }\r\n    }\r\n    transDOM (kmv) {\r\n        let data = kmv.$$data;\r\n        let newEle = document.createElement(this.tagName) ;\r\n        switch (this.nodeType) {\r\n            case NodeType.TEXT:\r\n                newEle = DomUtil.createTextNode(this.tagName);\r\n                newEle.textContent = compileTpl(this.template, data);\r\n                this.$dom = newEle;\r\n                break;\r\n            case NodeType.ELEMENT:\r\n                newEle = document.createElement(this.tagName);\r\n                this.$dom = newEle;\r\n                this.childrenVdom\r\n                &&\r\n                this.childrenVdom.forEach((child) => {\r\n                    newEle.appendChild(child.transDOM(kmv));\r\n                });\r\n                this.renderAttr(kmv);\r\n                break;\r\n        }\r\n        this.renderAttr(kmv);\r\n        return newEle;\r\n    }\r\n    reRender (kmv) {\r\n        let data = kmv.$$data;  // $$data迭代的每一个对象\r\n        let text = compileTpl(this.template, data);\r\n        switch (this.nodeType) {\r\n            case NodeType.TEXT:\r\n                DomUtil.changeTextContent(this.$dom, text)\r\n                break;\r\n            case NodeType.ELEMENT:\r\n                this.childrenVdom.forEach((child) => {\r\n                    child.reRender(kmv);\r\n                })\r\n                break;\r\n        }\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/vdom/ForNormalDOM.ts","import {　VDOM　} from './VDOM'\r\nimport {getDotVal} from \"../util/object\";\r\nexport class IfDOM extends VDOM {\r\n    methods;\r\n    nodeType;\r\n    tagName;\r\n    attributes;\r\n    template;\r\n    childrenVdom = [];\r\n    $dom;       // 联系真实dom\r\n    kif;\r\n    constructor(node) {\r\n        super(node);\r\n        // h3\r\n        this.tagName = node.tagName, this.attributes = node.attributes,\r\n            this.nodeType = node.nodeType;\r\n        this.kif = node.getAttribute(\"k-if\");\r\n        this.$dom = node;\r\n        node.removeAttribute(\"k-if\");\r\n    }\r\n    renderInit(kmv) {\r\n        let data = kmv.$data;\r\n        let isShow = getDotVal(data, this.kif);\r\n        if (!!isShow) {\r\n            this.$dom.style.display = \"block\";\r\n        } else {\r\n            this.$dom.style.display = \"none\";\r\n        }\r\n    }\r\n    reRender (kmv) {\r\n        let data = kmv.$data;\r\n        let isShow = getDotVal(data, this.kif);\r\n        if (!!isShow) {\r\n            this.$dom.style.display = \"block\";\r\n        } else {\r\n            this.$dom.style.display = \"none\";\r\n        }\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/vdom/IfDOM.ts","import { compileTpl } from '../util/template'\r\nimport * as DomUtil from '../dom/domOp'\r\nimport { NodeType } from \"../constants/constant\";\r\nimport { getDotVal, setObserveDotVal} from \"../util/object\";\r\n\r\nexport class InputDOM {\r\n    methods;\r\n    nodeType;\r\n    tagName;\r\n    attributes;\r\n    template;\r\n    childrenVdom = [];\r\n    $dom;       // 联系真实dom\r\n    kmodel;\r\n    constructor (node) {\r\n        // h3\r\n        this.tagName = node.tagName, this.attributes = node.attributes,\r\n            this.nodeType = node.nodeType;\r\n        this.kmodel = node.getAttribute(\"k-model\");\r\n        this.$dom = node;\r\n        node.removeAttribute(\"k-model\");\r\n    }\r\n    renderInit(kmv) {\r\n        let data = kmv.$data;\r\n        this.$dom.value = getDotVal(data, this.kmodel);\r\n        this.$dom.oninput = (ev) => {\r\n            setObserveDotVal(kmv.data, this.kmodel, this.$dom.value);\r\n        }\r\n    }\r\n    reRender (kmv) {\r\n        let data = kmv.$data;\r\n        let text = getDotVal(data, this.kmodel);\r\n        this.$dom.value = text;\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/vdom/InputDOM.ts","import { compileTpl } from '../util/template'\r\nimport * as DomUtil from '../dom/domOp'\r\nimport { NodeType } from \"../constants/constant\"\r\nimport { VDOM } from './VDOM';\r\n\r\nexport class NormalDOM extends VDOM {\r\n    methods;\r\n    nodeType;\r\n    tagName;\r\n    attributes;\r\n    template;\r\n    childrenVdom = [];\r\n    $dom;       // 联系真实dom\r\n    constructor (node) {\r\n        super(node);\r\n        // h3\r\n        this.tagName = node.tagName,\r\n        this.attributes = node.attributes && ([].slice.call(node.attributes).slice(0)),\r\n        this.nodeType = node.nodeType;\r\n        this.$dom = node;\r\n        switch (node.nodeType) {\r\n            case NodeType.TEXT:\r\n                this.template = node.textContent;\r\n                break;\r\n            case NodeType.ELEMENT:\r\n                this.template = node.firstChild.nodeValue;\r\n                break;\r\n        }\r\n        if (node.childNodes) {\r\n            for (let i = 0; i < node.childNodes.length; i++) {\r\n                let child = node.childNodes[i];\r\n                this.childrenVdom.push(new NormalDOM(child))\r\n            }\r\n        }\r\n    }\r\n    renderInit(kmv) {\r\n        let data = kmv.$data;\r\n        switch (this.nodeType) {\r\n            case NodeType.TEXT:\r\n                DomUtil.changeTextContent(this.$dom, compileTpl(this.template, data));\r\n                break;\r\n            case NodeType.ELEMENT:\r\n                this.childrenVdom.forEach((child) => {\r\n                    child.renderInit(kmv);\r\n                });\r\n                this.renderAttr(kmv);\r\n                break;\r\n        }\r\n    }\r\n    reRender (kmv) {\r\n        let data = kmv.$data;\r\n        let text = compileTpl(this.template, data);\r\n        switch (this.nodeType) {\r\n            case NodeType.TEXT:\r\n                DomUtil.changeTextContent(this.$dom, text)\r\n                break;\r\n            case NodeType.ELEMENT:\r\n                this.childrenVdom.forEach((child) => {\r\n                    child.reRender(kmv);\r\n                });\r\n                this.reRenderAttr(kmv);\r\n                break;\r\n        }\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/vdom/NormalDOM.ts"],"sourceRoot":""}