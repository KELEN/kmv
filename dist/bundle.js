!function(e){function t(n){if(r[n])return r[n].exports;var i=r[n]={exports:{},id:n,loaded:!1};return e[n].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)}([function(e,t,r){"use strict";function n(e){var t=e.el,r=document.querySelector(t),n=this;return this.data=e.data,this.flush=!1,this.watchers=new a.Watcher(r),this.$data=o.observer(e.data,this),this.methods=e.methods,setTimeout(function(){i.renderInit(n)},0),this}var i=r(6),o=r(10),a=r(11);window.Kmv=n,Object.defineProperty(t,"__esModule",{value:!0}),t.default=n},function(e,t){"use strict";t.Attr={K_MODEL:"k-model"},t.RegexpStr={brace:/\{\{((?:.|\n)+?)\}\}/,forStatement:/([a-z_]+[\w]*)\s+in\s+([a-z_][\w.]+)/,bracket:/\[['|"]?(\w+)['|"]?\]/,isString:/'([^']*)'|"([^\"]*)"/,isParams:/^[^"|^'\d]+.*/,arithmeticOp:/\*|\+|-\//g,inputElement:/INPUT|TEXTAREA/,arrtibuteKey:/k-for|k-model|k-if|k:.*|k-on:(.*)/,kAttribute:/k:(.*)/,kOnAttribute:/k-on:(.*)/,methodAndParam:/([a-zA-Z\d_]+)\((.*)\)/},t.NodeType={ELEMENT:1,ATTRIBUTE:2,TEXT:3,COMMENT:8,DOCUMENT:9},t.ArrayMethod=["push","pop","splice","shift","unshift","sort","reverse"];var r;!function(e){e[e.TEXT=0]="TEXT",e[e.INPUT=1]="INPUT",e[e.TEXTAREA=2]="TEXTAREA",e[e.FOR=3]="FOR",e[e.IF=4]="IF",e[e.ATTRIBUTE=5]="ATTRIBUTE"}(r=t.RenderType||(t.RenderType={}));var n;!function(e){e[e.PUSH=0]="PUSH",e[e.POP=1]="POP",e[e.SORT=2]="SORT",e[e.CHANGE=3]="CHANGE",e[e.SHIFT=4]="SHIFT"}(n=t.ArrayOp||(t.ArrayOp={}))},function(e,t,r){"use strict";var n=r(1);t.getDotVal=function(e,t){var r,i;if(t){t=t.replace(n.RegexpStr.bracket,".$1"),r=e;for(var o=t.split(".")||[t];i=o.shift();){if(!r){r=void 0;break}r=r[i]}}return r},t.depCopy=function(e){var r={};for(var n in e)"object"==typeof e[n]?Array.isArray(e[n])?r[n]=e[n].slice(0):r[n]=t.depCopy(e[n]):r[n]=e[n];return r},t.setObserveDotVal=function(e,t,r){t=t.replace(n.RegexpStr.bracket,".$1");for(var i=e,o=t.split("."),a=o.length,s=0;s<a-1;s++)i=i[o[s]];i[o[a-1]]=r}},function(module,exports,__webpack_require__){"use strict";var constant_1=__webpack_require__(1),object_1=__webpack_require__(2);exports.transArithmeticOp=function(tpl,obj){for(var opReg=constant_1.RegexpStr.arithmeticOp,arr=tpl.split(opReg),opRegArr=tpl.match(opReg),isParamReg=constant_1.RegexpStr.isParams,tmp,newStr="",i=0;i<arr.length;i++){if(tmp=arr[i].trim(),isParamReg.test(tmp)){var val=object_1.getDotVal(obj,tmp);isNaN(val)?newStr+='"'+val+'"':(val||(val=0),newStr+=val)}else newStr+=tmp;i<arr.length-1&&(newStr+=opRegArr[i])}return eval(newStr)},exports.compileTpl=function(e,t){for(var r,n=constant_1.RegexpStr.brace;r=n.exec(e);){var i=r?r[1].trim():"",o=constant_1.RegexpStr.arithmeticOp,a="";a=o.test(i)?exports.transArithmeticOp(i,t):object_1.getDotVal(t,i),e=e.replace(n,a)}return e}},function(e,t,r){"use strict";var n=r(1),i=r(3),o=r(7),a=r(5);t.insertAfter=function(e,t){e&&e.parentNode&&e.parentNode.insertBefore(t,e.nextSibling)},t.inserBefore=function(e,t){e&&e.parentNode&&e.parentNode.insertBefore(t,e)},t.deleteNode=function(e,t){e&&t&&e.removeChild(t)},t.changeNodeValue=function(e,t){e&&e.firstChild&&(e.firstChild.nodeValue=t)},t.removeAttribute=function(e,t){e.removeAttribute(t)},t.findIteratorNode=function(e,r){for(var n=e.childNodes,i=[],o=0;o<n.length;o++){var a=n[o];a.forString&&a.forKey&&a.forKey==r&&i.push(a),a.childNodes.length&&i.concat(t.findIteratorNode(a,r))}return i},t.hideNode=function(e){e.style.display="none"},t.showNode=function(e){e.style.display="block"},t.copyAttr=function(e,t,r){for(var s=r.$data,d=0;d<t.length;d++){var u=t[d],p=u.nodeName,l=u.nodeValue;if(o.isKvmAttribute(p,l)){if(n.RegexpStr.kAttribute.test(p)){var c=u.nodeName.replace(n.RegexpStr.kAttribute,"$1"),v=i.compileTpl(l,s);e.setAttribute(c,v),e.removeAttribute(p)}else if(n.RegexpStr.kOnAttribute.test(p)){var f=p.replace(n.RegexpStr.kOnAttribute,"$1"),h=i.compileTpl(l,s),m=h.match(n.RegexpStr.methodAndParam),g=m[1],b=m[2];a.bindEvent(e,f,g,b,r.methods,r.data),e.removeAttribute(p)}}else e.setAttribute(p,l)}},t.insertNodeByIndex=function(e,r,n){var i=e.tagName,o=0,a=e.groupId,s=e.attributes,d=e.template;if(0==r)e.innerText=n,e.style.display="";else{for(;o<r-1&&e;)e.nextSibling&&e.nextSibling.groupId==a&&o++,e=e.nextSibling;var u=document.createElement(i);u.groupId=a,u.template=d,u.innerText=n;for(var p=0;p<s.length;p++){var l=s[p];switch(l.name){default:u.setAttribute(l.name,l.nodeValue)}}t.insertAfter(e,u)}},t.removeNodeByIndex=function(e,t){var r=(e.tagName,0),n=e.groupId;if(0==t)e.nextSibling.groupId==n?(e.nextSibling.forKey=e.forKey,e.nextSibling.forString=e.forString,e.parentNode.removeChild(e)):(e.style.display="none",e.innerText="");else{for(;r<t&&e;)e.nextSibling&&e.groupId==n&&r++,e=e.nextSibling;e&&e.parentNode.removeChild(e)}},t.replaceNodeByIndex=function(e,t,r){for(var n=0,i=e.groupId;n<t&&e;)e.nextSibling&&e.nextSibling.groupId==i&&n++,e=e.nextSibling;e&&(e.innerText=r)},t.removeNode=function(e){e&&e.parentNode.removeChild(e)}},function(e,t){"use strict";t.bindEvent=function(e,t,r,n,i,o){void 0===n&&(n=""),e.addEventListener?e.addEventListener(t,function(){var e=n.split(",");i[r].apply(o,e)}):e.attachEvent("on"+t,function(){var e=n.split(",");i[r].apply(o,e)})}},function(e,t,r){"use strict";var n=r(3),i=r(1),o=r(2),a=r(9),s=r(4),d=r(5);t.renderInit=function(e){for(var t=e.watchers,r=e.$data,a=e.data,u=t.getQueue(),p=function(t){var p=u[t];switch(p.renderType){case i.RenderType.TEXT:var l=p.template,c=n.compileTpl(l,r);p.nodeValue=c;break;case i.RenderType.INPUT:var v=p.getAttribute("k-model");p.value=o.getDotVal(r,v),p.oninput=function(){o.setObserveDotVal(a,v,this.value)};break;case i.RenderType.FOR:p.renderInit(e);break;case i.RenderType.IF:var f=p.getAttribute("k-if"),h=o.getDotVal(r,f);h?s.showNode(p):s.hideNode(p),p.kIf=f;break;case i.RenderType.ATTRIBUTE:for(var m=p.nAttr,g=p.kAttr,b=p.kOn,y=0;y<g.length;y++){var T=g[y].kAttr.replace(i.RegexpStr.kAttribute,"$1"),A=n.compileTpl(g[y].kAttrVal,r);p.setAttribute(T,A)}for(var S=0;S<b.length;S++){var x=b[S].kEvent.replace(i.RegexpStr.kOnAttribute,"$1"),R=n.compileTpl(b[S].kFunc,r),N=R.match(i.RegexpStr.methodAndParam);if(N){var O=N[1],k=N[2];d.bindEvent(p,x,O,k,e.methods,e.data)}else d.bindEvent(p,x,R,"",e.methods,e.data);s.removeAttribute(p,b[S].kEvent)}for(var E=0;E<m.length;E++){var T=m[E].nAttr.replace(i.RegexpStr.kAttribute,"$1"),I=n.compileTpl(m[E].nAttrVal,r);p.setAttribute(T,I)}}},l=0;l<u.length;l++)p(l)},t.reRender=function(e,t){for(var r=e.watchers.getQueue(),a=e.$data,d=0;d<r.length;d++){var u=r[d];switch(u.renderType){case i.RenderType.TEXT:var p=u.template;u.nodeValue=n.compileTpl(p,a);break;case i.RenderType.FOR:u.reRenderList(e);break;case i.RenderType.IF:var l=u.kIf,c=o.getDotVal(a,l);c?s.showNode(u):s.hideNode(u)}}},t.reRenderFor=function(e,t){for(var r=e.watchers.getQueue(),n=e.$data,s=0;s<r.length;s++){var d=r[s];if(d.renderType==i.RenderType.FOR){var u=d.vdom,p=u.forObjectKey,l=o.getDotVal(n,p),c=a.diff(u.arrayData,l);d.reRender(c,e)}}}},function(e,t,r){"use strict";var n=r(1),i=function(e){return n.RegexpStr.brace.test(e)},o=function(e){return n.RegexpStr.forStatement.test(e)},a={isBraceReg:i,isForStatement:o};t.isKvmAttribute=function(e,t){return n.RegexpStr.arrtibuteKey.test(e)||n.RegexpStr.brace.test(t)},Object.defineProperty(t,"__esModule",{value:!0}),t.default=a},function(e,t,r){"use strict";var n=r(3),i=r(4),o=function(){function e(e){this.vdom={tagName:e.tagName,template:e.firstChild.nodeValue,attributes:e.attributes}}return e.prototype.transDOM=function(e){var t=e.$data,r=document.createElement(this.vdom.tagName);r.template=this.vdom.template;var o=n.compileTpl(this.vdom.template,t);return r.innerText=o,i.copyAttr(r,this.vdom.attributes,e),r},e}();t.NormalDOM=o},function(e,t,r){"use strict";var n=r(1);t.diff=function(e,t){for(var r=[],i=e.length,o=t.length,a=Math.min(i,o),s=0;s<a;s++)e[s]!==t[s]&&r.push({op:n.ArrayOp.CHANGE,index:s,text:t[s]});if(i>o)for(var d=e.slice(o),s=0;s<d.length;s++)r.push({op:n.ArrayOp.POP,index:s+o,text:d[s]});else for(var u=t.slice(i),s=0;s<u.length;s++)r.push({op:n.ArrayOp.PUSH,index:s+a,text:u[s]});return r}},function(e,t,r){"use strict";function n(e,t,r){var n;a.ArrayMethod.forEach(function(i){Object.defineProperty(e,i,{configurable:!1,enumerable:!1,writable:!1,value:function(){Array.prototype[i].apply(s.getDotVal(t.$data,r),arguments),n&&clearTimeout(n),n=setTimeout(function(){o.reRenderFor(t,r)},10)}})})}var i=r(2),o=r(6),a=r(1),s=r(2);t.observer=function(e,r,a){void 0===a&&(a="");var d=i.depCopy(e),u=function(d){var u=a?a+"."+d:d;"object"==typeof e[d]?Array.isArray(e[d])?n(e[d],r,u):t.observer(e[d],r,u):Object.defineProperty(e,d,{set:function(e){i.setObserveDotVal(r.$data,u,e),o.reRender(r,d)},get:function(){return s.getDotVal(r.$data,u)}})};for(var p in e)u(p);return d}},function(e,t,r){"use strict";var n=r(1),i=r(7),o=r(13),a=function(){function e(e){this.queue=[],this.queue=this.queueInit(e)}return e.prototype.getQueue=function(){return this.queue},e.prototype.queueInit=function(e){for(var t=e.childNodes,r=0;r<t.length;r++){var a=t[r];switch(a.nodeType){case n.NodeType.TEXT:var s=a.nodeValue;n.RegexpStr.brace.test(s)&&(a.renderType=n.RenderType.TEXT,a.template=s,this.queue.push(a));break;case n.NodeType.ELEMENT:if(a.getAttribute("k-for")){var d=new o.ForDOM(a);d.renderType=n.RenderType.FOR,this.queue.push(d),a.parentNode.removeChild(a)}else if(a.getAttribute("k-if"))a.renderType=n.RenderType.IF,this.queue.push(a);else if(a.getAttribute("k-model"))for(var u=a.attributes,p=0;p<u.length;p++){var l=u[p];if(i.isKvmAttribute(l.nodeName,l.nodeValue)){a.renderType=n.RenderType.INPUT,this.queue.push(a);break}}else{var u=a.attributes;a.nAttr=[],a.kAttr=[],a.kOn=[];for(var p=0;p<u.length;p++){var l=u[p];i.isKvmAttribute(l.nodeName,l.nodeValue)&&(a.renderType=n.RenderType.ATTRIBUTE,n.RegexpStr.kAttribute.test(l.nodeName)?(a.kAttr.push({kAttr:l.nodeName,kAttrVal:l.nodeValue}),a.removeAttribute(l.nodeName)):n.RegexpStr.kOnAttribute.test(l.nodeName)?a.kOn.push({kEvent:l.nodeName,kFunc:l.nodeValue}):a.nAttr.push({nAttr:l.nodeName,nAttrVal:l.nodeValue}))}a.renderType===n.RenderType.ATTRIBUTE&&this.queue.push(a)}}a.childNodes.length&&this.queue.concat(this.queueInit(a))}return this.queue},e}();t.Watcher=a},function(e,t,r){"use strict";var n=r(4),i=r(2),o=r(3),a=r(1),s=r(1),d=r(8),u=function(){function e(e){var t=e.getAttribute("k-for"),r=a.RegexpStr.forStatement.exec(t),n=e.firstChild&&e.firstChild.nodeValue;if(this.vdom={tagName:e.tagName,forString:t,forObjectKey:r[2].trim(),forKey:r[1].trim(),template:n,previousSibling:e.previousSibling,nextSibling:e.nextSibling,documentFragment:null,children:[],arrayData:[],attributes:e.attributes},this.vdom.attributes.removeNamedItem("k-for"),e.children)for(var i=0;i<e.children.length;i++){var o=new d.NormalDOM(e.children[i]);this.vdom.children.push(o)}this.connect(e.previousElementSibling,e.nextElementSibling)}return e.prototype.getVdom=function(){return this.vdom},e.prototype.renderInit=function(e){for(var t=e.$data,r=this.vdom.tagName,a=this.vdom.template,s=this.vdom.forObjectKey,d=i.getDotVal(t,s),u=document.createDocumentFragment(),p=i.depCopy(t),l=0;l<d.length;l++){var c=document.createElement(r),v=i.getDotVal(t,this.vdom.forObjectKey+"."+l);p[this.vdom.forKey]=v,c.innerText=o.compileTpl(a,p);for(var f=0;f<this.vdom.children.length;f++)c.appendChild(this.vdom.children[f].transDOM(e));n.copyAttr(c,this.vdom.attributes,e),u.appendChild(c)}n.insertAfter(this.vdom.previousSibling,u),this.vdom.arrayData=d.slice(0)},e.prototype.connect=function(e,t){e&&(e.$nextSibling=this.vdom),this.vdom.$nextSibling=t},e.prototype.reRender=function(e,t){for(var r=t.$data,n=0;n<e.length;n++){var o=e[n].op;switch(o){case s.ArrayOp.PUSH:this.pushDOM(t,e[n].index);break;case s.ArrayOp.POP:this.popDOM();break;case s.ArrayOp.CHANGE:var a=i.depCopy(r);this.changeText(a,e[n].index);break;case s.ArrayOp.SHIFT:this.shiftDOM()}}var d=this.vdom.forObjectKey,u=i.getDotVal(r,d);this.vdom.arrayData=u.slice(0)},e.prototype.reRenderList=function(e){for(var t=e.$data,r=this.vdom.previousSibling,a=this.vdom.nextSibling,s=0,d=i.depCopy(t),u=this.vdom.template;r!==a;){r=r.nextSibling;var p=i.getDotVal(t,this.vdom.forObjectKey+"."+s);d[this.vdom.forKey]=p,p=o.compileTpl(u,d),n.changeNodeValue(r,p);for(var l=r.children||[],c=0;c<l.length;c++)this.reRenderChild(l[c],t);s++}},e.prototype.reRenderChild=function(e,t){var r=e.template;e.firstChild.nodeValue=o.compileTpl(r,t)},e.prototype.pushDOM=function(e,t){var r=e.$data,a=document.createElement(this.vdom.tagName),s=i.getDotVal(r,this.vdom.forObjectKey+"."+t),d=this.vdom.template,u=i.depCopy(r);u[this.vdom.forKey]=s,a.innerText=o.compileTpl(d,u);for(var p=0;p<this.vdom.children.length;p++)a.appendChild(this.vdom.children[p].transDOM(r));n.copyAttr(a,this.vdom.attributes,e),n.inserBefore(this.vdom.nextSibling,a)},e.prototype.popDOM=function(){n.deleteNode(this.vdom.nextSibling.parentNode,this.vdom.nextSibling.previousSibling)},e.prototype.shiftDOM=function(){n.deleteNode(this.vdom.previousSibling.parentNode,this.vdom.previousSibling.nextSibling)},e.prototype.changeText=function(e,t){for(var r=this.vdom.previousSibling,o=this.vdom.nextSibling,a=-1;r!=o&&a<t;)r=r.nextSibling,a++;var s=i.getDotVal(e,this.vdom.forObjectKey+"."+a);n.changeNodeValue(r,s)},e}();t.ForDOM=u},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}n(r(12)),n(r(8))}]);
//# sourceMappingURL=bundle.js.map